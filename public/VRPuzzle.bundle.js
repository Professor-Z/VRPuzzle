!function(e){function t(n){if(i[n])return i[n].exports;var s=i[n]={exports:{},id:n,loaded:!1};return e[n].call(s.exports,s,s.exports,t),s.loaded=!0,s.exports}var i={};return t.m=e,t.c=i,t.p="/VRPuzzle/public/",t(0)}([function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}i(5);var s=i(1),r=n(s),o=new r["default"],a=function(){o.render()};a()},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=i(2),a=n(o),h=i(4),c=n(h),l=function(){function e(){s(this,e),this.scene=new THREE.Scene,this.camera=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,1e4),this.camera.position.set(0,10,0),this.controls=new THREE.DeviceOrientationControls(this.camera),this.renderer=new THREE.WebGLRenderer({antialias:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.domElement.style.position="absolute",this.renderer.domElement.style.top=0,document.body.appendChild(this.renderer.domElement),this.raycaster=new THREE.Raycaster,this.mouse=new a["default"],this.onTextureLoaded=this.onTextureLoaded.bind(this),this.onResize=this.onResize.bind(this),this.render=this.render.bind(this),this.placePieces=this.placePieces.bind(this),this.meshList=[],this.logFlag=!0,this.boxSize=30,this.onTextureLoaded(),window.addEventListener("resize",this.onResize,!0),this.lastRender=0,this.display=null}return r(e,[{key:"onTextureLoaded",value:function(){var e=new THREE.BoxGeometry(this.boxSize,this.boxSize,this.boxSize),t=new THREE.MeshBasicMaterial({color:16711935,side:THREE.BackSide,wireframe:!0});this.skybox=new THREE.Mesh(e,t),this.skybox.position.y=this.boxSize/2,this.scene.add(this.skybox),this.placePieces(),this.placeSphere()}},{key:"placeSphere",value:function(){var e=new THREE.SphereGeometry(50,16,8);e.scale(-1,1,1);var t=new THREE.TextureLoader,i=this;t.load("public/images/sphere (2).jpg",function(t){var n=new THREE.MeshBasicMaterial({map:t}),s=new THREE.Mesh(e,n);s.position.set(0,0,10),i.scene.add(s)})}},{key:"placePieces",value:function(){this.columnNumber=4,this.pieceNumber=this.columnNumber*this.columnNumber,this.scaledWidth=16,this.scaledHeight=9,this.freePieceNumber=1*this.pieceNumber/2,this.freePieceList=[],this.planeWidth=this.scaledWidth/this.columnNumber,this.planeHeight=this.scaledHeight/this.columnNumber,this.selectedMesh=null,this.holdMap={},this.meshCanvasMap={};var e=new Image;e.src=i(3);var t=document.createElement("canvas"),n=t.getContext("2d"),s=this;e.onload=function(){var i=t.width/1.5/e.width,r=t.height/1.5/e.height;s.scale=Math.min(i,r),s.pieceWidth=e.width/s.columnNumber,s.pieceHeight=e.height/s.columnNumber;for(var o,a,h,c=0,l=0;c<s.columnNumber;c++)for(var d=0;d<s.columnNumber;d++,l++){t=document.createElement("canvas"),n=t.getContext("2d"),o=new THREE.Texture(t),n.drawImage(e,c*s.pieceWidth,d*s.pieceHeight,s.pieceWidth,s.pieceHeight,0,0,t.width,t.height),o&&(o.needsUpdate=!0),a=new THREE.MeshBasicMaterial({map:o,side:THREE.DoubleSide}),a.transparent=!1,h=new THREE.Mesh(new THREE.PlaneGeometry(s.planeWidth,s.planeHeight),a);var u=Math.random();if(u<s.freePieceNumber/(s.columnNumber*s.columnNumber-l)&&s.freePieceNumber>0){var p=-s.boxSize/2+s.planeWidth/2+Math.random()*(s.boxSize-s.planeWidth),m=-s.boxSize/2+s.planeHeight/2+Math.random()*(s.boxSize-s.planeHeight);h.rotation.x=Math.PI/2,h.position.set(Math.round(p),.5,Math.round(m));var f=h.clone();s.holdMap[h.id]=f,f.rotation.x=0,f.material=new THREE.MeshBasicMaterial({color:8421504,side:THREE.DoubleSide}),f.position.set(c*s.planeWidth-s.scaledWidth/2+s.planeWidth/2,5+s.scaledHeight-s.planeHeight/2-d*s.planeHeight,-9.99),s.scene.add(f),s.freePieceNumber--,s.freePieceList.push(h.id),s.meshCanvasMap[h.id]=t}else h.position.set(c*s.planeWidth-s.scaledWidth/2+s.planeWidth/2,5+s.scaledHeight-s.planeHeight/2-d*s.planeHeight,-9.99);s.meshList.push(h),s.scene.add(h)}}}},{key:"render",value:function(e){this.lastRender=e,this.raycaster.setFromCamera(this.mouse,this.camera);var t=this.raycaster.intersectObjects(this.scene.children);if(this.mouse.x=this.mouse.y=void 0,t.length>0){var i=!1,n=!0,s=!1,r=void 0;try{for(var o,a=this.meshList[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var h=o.value;this.freePieceList.indexOf(h.id)>-1&&h.id==t[0].object.id&&(console.log(1),null!==this.selectedMesh&&(this.clearCanvas(),this.selectedMesh.visible=!0),this.selectedMesh=h,console.log(2),this.mouse.pickBtn.innerHTML="贴上",i=!0,h.visible=!1,document.getElementById("pin").appendChild(this.meshCanvasMap[h.id]),console.log(3))}}catch(l){s=!0,r=l}finally{try{!n&&a["return"]&&a["return"]()}finally{if(s)throw r}}if(this.selectedMesh&&this.holdMap[this.selectedMesh.id].id==t[0].object.id){var d=t[0].object.position;this.selectedMesh.position.set(d.x,d.y,d.z),this.selectedMesh.rotation.set(0,0,0),this.holdMap[this.selectedMesh.id].position.z-=1,this.selectedMesh.visible=!0,this.mouse.pickBtn.innerHTML="捡起",this.freePieceList.splice(this.freePieceList.indexOf(this.selectedMesh.id),1),this.clearCanvas(),this.selectedMesh=null,0==this.freePieceList.length&&(0,c["default"])({title:"恭喜！",text:"成功拼完了一张图，可是我也不会给你流量",confirmButtonText:"好的"})}this.selectedMesh&&!i&&(this.mouse.pickBtn.innerHTML="捡起",this.selectedMesh.visible=!0,this.clearCanvas(),this.selectedMesh=null)}this.controls.update(),this.renderer.render(this.scene,this.camera),requestAnimationFrame(this.render)}},{key:"onResize",value:function(e){this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(window.innerWidth,window.innerHeight)}},{key:"clearCanvas",value:function(){for(var e=document.querySelector("#pin canvas"),t=document.getElementById("pin");null!=e;)t.removeChild(e),e=document.querySelector("#pin canvas")}}]),e}();t["default"]=l},function(e,t){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=function(e){function t(e){i(this,t);var s=n(this,Object.getPrototypeOf(t).call(this,e));return s.x=void 0,s.y=void 0,s.pickBtn=document.getElementById("pick-btn"),s.pickHand=document.getElementById("pick-hand"),s.pickBtn.addEventListener("click",s.btnOnClick.bind(s),!1),s}return s(t,e),r(t,[{key:"onMouseClick",value:function(e){this.x=e.clientX/window.innerWidth*2-1,this.y=2*-(e.clientY/window.innerHeight)+1}},{key:"btnOnClick",value:function(e){this.x=.92-1,this.y=-.79+1}}]),t}(THREE.Vector2);t["default"]=o},function(e,t,i){e.exports=i.p+"images/puzzles/cartoon (3).jpg"},function(e,t){e.exports=swal},function(e,t){e.exports=!0}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vVlJQdXp6bGUuYnVuZGxlLmpzIiwid2VicGFjazovLy93ZWJwYWNrL2Jvb3RzdHJhcCBiMGRhYmVjMDhmMzIyYzgwNDYwNiIsIndlYnBhY2s6Ly8vLi9zcmMvamF2YXNjcmlwdHMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2phdmFzY3JpcHRzL2dhbWUuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2phdmFzY3JpcHRzL21vdXNlLmpzIiwid2VicGFjazovLy8uL3B1YmxpYy9pbWFnZXMvcHV6emxlcy9jYXJ0b29uICgzKS5qcGciLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIFwic3dhbFwiIiwid2VicGFjazovLy9leHRlcm5hbCBcInRydWVcIiJdLCJuYW1lcyI6WyJtb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiaW5zdGFsbGVkTW9kdWxlcyIsImV4cG9ydHMiLCJtb2R1bGUiLCJpZCIsImxvYWRlZCIsImNhbGwiLCJtIiwiYyIsInAiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0Iiwib2JqIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJfZ2FtZSIsIl9nYW1lMiIsImdhbWUiLCJsb29wIiwicmVuZGVyIiwiX2NsYXNzQ2FsbENoZWNrIiwiaW5zdGFuY2UiLCJDb25zdHJ1Y3RvciIsIlR5cGVFcnJvciIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwidmFsdWUiLCJfY3JlYXRlQ2xhc3MiLCJkZWZpbmVQcm9wZXJ0aWVzIiwidGFyZ2V0IiwicHJvcHMiLCJpIiwibGVuZ3RoIiwiZGVzY3JpcHRvciIsImVudW1lcmFibGUiLCJjb25maWd1cmFibGUiLCJ3cml0YWJsZSIsImtleSIsInByb3RvUHJvcHMiLCJzdGF0aWNQcm9wcyIsInByb3RvdHlwZSIsIl9tb3VzZSIsIl9tb3VzZTIiLCJfc3dlZXRhbGVydCIsIl9zd2VldGFsZXJ0MiIsIkdhbWUiLCJ0aGlzIiwic2NlbmUiLCJUSFJFRSIsIlNjZW5lIiwiY2FtZXJhIiwiUGVyc3BlY3RpdmVDYW1lcmEiLCJ3aW5kb3ciLCJpbm5lcldpZHRoIiwiaW5uZXJIZWlnaHQiLCJwb3NpdGlvbiIsInNldCIsImNvbnRyb2xzIiwiRGV2aWNlT3JpZW50YXRpb25Db250cm9scyIsInJlbmRlcmVyIiwiV2ViR0xSZW5kZXJlciIsImFudGlhbGlhcyIsInNldFBpeGVsUmF0aW8iLCJkZXZpY2VQaXhlbFJhdGlvIiwic2V0U2l6ZSIsImRvbUVsZW1lbnQiLCJzdHlsZSIsInRvcCIsImRvY3VtZW50IiwiYm9keSIsImFwcGVuZENoaWxkIiwicmF5Y2FzdGVyIiwiUmF5Y2FzdGVyIiwibW91c2UiLCJvblRleHR1cmVMb2FkZWQiLCJiaW5kIiwib25SZXNpemUiLCJwbGFjZVBpZWNlcyIsIm1lc2hMaXN0IiwibG9nRmxhZyIsImJveFNpemUiLCJhZGRFdmVudExpc3RlbmVyIiwibGFzdFJlbmRlciIsImRpc3BsYXkiLCJnZW9tZXRyeSIsIkJveEdlb21ldHJ5IiwibWF0ZXJpYWwiLCJNZXNoQmFzaWNNYXRlcmlhbCIsImNvbG9yIiwic2lkZSIsIkJhY2tTaWRlIiwid2lyZWZyYW1lIiwic2t5Ym94IiwiTWVzaCIsInkiLCJhZGQiLCJwbGFjZVNwaGVyZSIsIlNwaGVyZUdlb21ldHJ5Iiwic2NhbGUiLCJsb2FkZXIiLCJUZXh0dXJlTG9hZGVyIiwic2VsZiIsImxvYWQiLCJ0ZXh0dXJlIiwibWFwIiwibWVzaCIsImNvbHVtbk51bWJlciIsInBpZWNlTnVtYmVyIiwic2NhbGVkV2lkdGgiLCJzY2FsZWRIZWlnaHQiLCJmcmVlUGllY2VOdW1iZXIiLCJmcmVlUGllY2VMaXN0IiwicGxhbmVXaWR0aCIsInBsYW5lSGVpZ2h0Iiwic2VsZWN0ZWRNZXNoIiwiaG9sZE1hcCIsIm1lc2hDYW52YXNNYXAiLCJpbWFnZU9iaiIsIkltYWdlIiwic3JjIiwiY2FudmFzIiwiY3JlYXRlRWxlbWVudCIsImNvbnRleHQiLCJnZXRDb250ZXh0Iiwib25sb2FkIiwid3MiLCJ3aWR0aCIsImhzIiwiaGVpZ2h0IiwiTWF0aCIsIm1pbiIsInBpZWNlV2lkdGgiLCJwaWVjZUhlaWdodCIsImluZGV4IiwiaiIsIlRleHR1cmUiLCJkcmF3SW1hZ2UiLCJuZWVkc1VwZGF0ZSIsIkRvdWJsZVNpZGUiLCJ0cmFuc3BhcmVudCIsIlBsYW5lR2VvbWV0cnkiLCJyYW5kb20iLCJ4IiwieiIsInJvdGF0aW9uIiwiUEkiLCJyb3VuZCIsImJsYW5rTWVzaCIsImNsb25lIiwicHVzaCIsInRpbWVzdGFtcCIsInNldEZyb21DYW1lcmEiLCJpbnRlcnNlY3RzIiwiaW50ZXJzZWN0T2JqZWN0cyIsImNoaWxkcmVuIiwidW5kZWZpbmVkIiwiY2xpY2tGbGFnIiwiX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiIsIl9kaWRJdGVyYXRvckVycm9yIiwiX2l0ZXJhdG9yRXJyb3IiLCJfc3RlcCIsIl9pdGVyYXRvciIsIlN5bWJvbCIsIml0ZXJhdG9yIiwibmV4dCIsImRvbmUiLCJpbmRleE9mIiwib2JqZWN0IiwiY29uc29sZSIsImxvZyIsImNsZWFyQ2FudmFzIiwidmlzaWJsZSIsInBpY2tCdG4iLCJpbm5lckhUTUwiLCJnZXRFbGVtZW50QnlJZCIsImVyciIsInQiLCJzcGxpY2UiLCJ0aXRsZSIsInRleHQiLCJjb25maXJtQnV0dG9uVGV4dCIsInVwZGF0ZSIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsImUiLCJhc3BlY3QiLCJ1cGRhdGVQcm9qZWN0aW9uTWF0cml4IiwicXVlcnlTZWxlY3RvciIsInBpbiIsInJlbW92ZUNoaWxkIiwiX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4iLCJSZWZlcmVuY2VFcnJvciIsIl9pbmhlcml0cyIsInN1YkNsYXNzIiwic3VwZXJDbGFzcyIsImNyZWF0ZSIsImNvbnN0cnVjdG9yIiwic2V0UHJvdG90eXBlT2YiLCJfX3Byb3RvX18iLCJNb3VzZSIsIl9USFJFRSRWZWN0b3IiLCJfdGhpcyIsImdldFByb3RvdHlwZU9mIiwicGlja0hhbmQiLCJidG5PbkNsaWNrIiwiZXZlbnQiLCJjbGllbnRY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LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqKioqKi8gKGZ1bmN0aW9uKG1vZHVsZXMpIHsgLy8gd2VicGFja0Jvb3RzdHJhcFxuLyoqKioqKi8gXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuLyoqKioqKi8gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuLyoqKioqKi8gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKVxuLyoqKioqKi8gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4vKioqKioqLyBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuLyoqKioqKi8gXHRcdFx0ZXhwb3J0czoge30sXG4vKioqKioqLyBcdFx0XHRpZDogbW9kdWxlSWQsXG4vKioqKioqLyBcdFx0XHRsb2FkZWQ6IGZhbHNlXG4vKioqKioqLyBcdFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4vKioqKioqLyBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbi8qKioqKiovIFx0XHRtb2R1bGUubG9hZGVkID0gdHJ1ZTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbi8qKioqKiovIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4vKioqKioqLyBcdH1cbi8qKioqKiovXG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiL1ZSUHV6emxlL3B1YmxpYy9cIjtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLyoqKioqKi8gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygwKTtcbi8qKioqKiovIH0pXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuLyoqKioqKi8gKFtcbi8qIDAgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdFwidXNlIHN0cmljdFwiO1xuXHRcblx0X193ZWJwYWNrX3JlcXVpcmVfXyg1KTtcblx0XG5cdHZhciBfZ2FtZSA9IF9fd2VicGFja19yZXF1aXJlX18oMSk7XG5cdFxuXHR2YXIgX2dhbWUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ2FtZSk7XG5cdFxuXHRmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXHRcblx0dmFyIGdhbWUgPSBuZXcgX2dhbWUyLmRlZmF1bHQoKTtcblx0XG5cdHZhciBsb29wID0gZnVuY3Rpb24gbG9vcCgpIHtcblx0ICAgIGdhbWUucmVuZGVyKCk7XG5cdCAgICAvLyByZXF1ZXN0QW5pbWF0aW9uRnJhbWUobG9vcClcblx0fTtcblx0bG9vcCgpO1xuXG4vKioqLyB9LFxuLyogMSAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0XCJ1c2Ugc3RyaWN0XCI7XG5cdFxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcblx0ICAgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRcblx0dmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblx0XG5cdHZhciBfbW91c2UgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpO1xuXHRcblx0dmFyIF9tb3VzZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9tb3VzZSk7XG5cdFxuXHR2YXIgX3N3ZWV0YWxlcnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpO1xuXHRcblx0dmFyIF9zd2VldGFsZXJ0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3N3ZWV0YWxlcnQpO1xuXHRcblx0ZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblx0XG5cdGZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cdFxuXHR2YXIgR2FtZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIGZ1bmN0aW9uIEdhbWUoKSB7XG5cdCAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEdhbWUpO1xuXHRcblx0ICAgICAgICAvLyBDcmVhdGUgYSB0aHJlZS5qcyBzY2VuZS5cblx0ICAgICAgICB0aGlzLnNjZW5lID0gbmV3IFRIUkVFLlNjZW5lKCk7XG5cdFxuXHQgICAgICAgIC8vIENyZWF0ZSBhIHRocmVlLmpzIGNhbWVyYS5cblx0ICAgICAgICB0aGlzLmNhbWVyYSA9IG5ldyBUSFJFRS5QZXJzcGVjdGl2ZUNhbWVyYSg3NSwgd2luZG93LmlubmVyV2lkdGggLyB3aW5kb3cuaW5uZXJIZWlnaHQsIDAuMSwgMTAwMDApO1xuXHRcblx0ICAgICAgICB0aGlzLmNhbWVyYS5wb3NpdGlvbi5zZXQoMCwgMTAsIDApO1xuXHQgICAgICAgIHRoaXMuY29udHJvbHMgPSBuZXcgVEhSRUUuRGV2aWNlT3JpZW50YXRpb25Db250cm9scyh0aGlzLmNhbWVyYSk7XG5cdFxuXHQgICAgICAgIHRoaXMucmVuZGVyZXIgPSBuZXcgVEhSRUUuV2ViR0xSZW5kZXJlcih7XG5cdCAgICAgICAgICAgIGFudGlhbGlhczogdHJ1ZVxuXHQgICAgICAgIH0pO1xuXHQgICAgICAgIHRoaXMucmVuZGVyZXIuc2V0UGl4ZWxSYXRpbyh3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyk7XG5cdCAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRTaXplKHdpbmRvdy5pbm5lcldpZHRoLCB3aW5kb3cuaW5uZXJIZWlnaHQpO1xuXHQgICAgICAgIHRoaXMucmVuZGVyZXIuZG9tRWxlbWVudC5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7XG5cdCAgICAgICAgdGhpcy5yZW5kZXJlci5kb21FbGVtZW50LnN0eWxlLnRvcCA9IDA7XG5cdCAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh0aGlzLnJlbmRlcmVyLmRvbUVsZW1lbnQpO1xuXHRcblx0ICAgICAgICAvLyByYXljYXN0ZXJcblx0ICAgICAgICB0aGlzLnJheWNhc3RlciA9IG5ldyBUSFJFRS5SYXljYXN0ZXIoKTtcblx0ICAgICAgICB0aGlzLm1vdXNlID0gbmV3IF9tb3VzZTIuZGVmYXVsdCgpO1xuXHQgICAgICAgIC8vYmluZCB0aGlzXG5cdCAgICAgICAgdGhpcy5vblRleHR1cmVMb2FkZWQgPSB0aGlzLm9uVGV4dHVyZUxvYWRlZC5iaW5kKHRoaXMpO1xuXHQgICAgICAgIHRoaXMub25SZXNpemUgPSB0aGlzLm9uUmVzaXplLmJpbmQodGhpcyk7XG5cdCAgICAgICAgdGhpcy5yZW5kZXIgPSB0aGlzLnJlbmRlci5iaW5kKHRoaXMpO1xuXHQgICAgICAgIHRoaXMucGxhY2VQaWVjZXMgPSB0aGlzLnBsYWNlUGllY2VzLmJpbmQodGhpcyk7XG5cdCAgICAgICAgLy9cblx0ICAgICAgICB0aGlzLm1lc2hMaXN0ID0gW107XG5cdCAgICAgICAgdGhpcy5sb2dGbGFnID0gdHJ1ZTtcblx0ICAgICAgICAvLyBBZGQgYSByZXBlYXRpbmcgZ3JpZCBhcyBhIHNreWJveC5cblx0ICAgICAgICB0aGlzLmJveFNpemUgPSAzMDtcblx0ICAgICAgICAvLyB0aGlzLmxvYWRlciA9IG5ldyBUSFJFRS5UZXh0dXJlTG9hZGVyKClcblx0ICAgICAgICAvLyB0aGlzLmxvYWRlci5sb2FkKFwicHVibGljL2ltYWdlcy9ib3gucG5nXCIsIHRoaXMub25UZXh0dXJlTG9hZGVkKVxuXHQgICAgICAgIC8vIGxldCB0ZXh0dXJlID0gbmV3IFRIUkVFLlRleHR1cmUoKVxuXHQgICAgICAgIHRoaXMub25UZXh0dXJlTG9hZGVkKCk7XG5cdCAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJyZXNpemVcIiwgdGhpcy5vblJlc2l6ZSwgdHJ1ZSk7XG5cdCAgICAgICAgLy8gd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJ2cmRpc3BsYXlwcmVzZW50Y2hhbmdlXCIsIHRoaXMub25SZXNpemUsIHRydWUpXG5cdCAgICAgICAgdGhpcy5sYXN0UmVuZGVyID0gMDtcblx0ICAgICAgICB0aGlzLmRpc3BsYXkgPSBudWxsO1xuXHQgICAgfVxuXHRcblx0ICAgIF9jcmVhdGVDbGFzcyhHYW1lLCBbe1xuXHQgICAgICAgIGtleTogXCJvblRleHR1cmVMb2FkZWRcIixcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gb25UZXh0dXJlTG9hZGVkKCkge1xuXHQgICAgICAgICAgICAvLyB0ZXh0dXJlLndyYXBTID0gVEhSRUUuUmVwZWF0V3JhcHBpbmdcblx0ICAgICAgICAgICAgLy8gdGV4dHVyZS53cmFwVCA9IFRIUkVFLlJlcGVhdFdyYXBwaW5nXG5cdCAgICAgICAgICAgIC8vIHRleHR1cmUucmVwZWF0LnNldCh0aGlzLmJveFNpemUsIHRoaXMuYm94U2l6ZSlcblx0XG5cdCAgICAgICAgICAgIHZhciBnZW9tZXRyeSA9IG5ldyBUSFJFRS5Cb3hHZW9tZXRyeSh0aGlzLmJveFNpemUsIHRoaXMuYm94U2l6ZSwgdGhpcy5ib3hTaXplKTtcblx0ICAgICAgICAgICAgdmFyIG1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hCYXNpY01hdGVyaWFsKHsgY29sb3I6IDB4ZmYwMGZmLCBzaWRlOiBUSFJFRS5CYWNrU2lkZSwgd2lyZWZyYW1lOiB0cnVlIH0pO1xuXHRcblx0ICAgICAgICAgICAgLy8gQWxpZ24gdGhlIHNreWJveCB0byB0aGUgZmxvb3IgKHdoaWNoIGlzIGF0IHk9MCkuXG5cdCAgICAgICAgICAgIHRoaXMuc2t5Ym94ID0gbmV3IFRIUkVFLk1lc2goZ2VvbWV0cnksIG1hdGVyaWFsKTtcblx0ICAgICAgICAgICAgdGhpcy5za3lib3gucG9zaXRpb24ueSA9IHRoaXMuYm94U2l6ZSAvIDI7XG5cdCAgICAgICAgICAgIHRoaXMuc2NlbmUuYWRkKHRoaXMuc2t5Ym94KTtcblx0ICAgICAgICAgICAgdGhpcy5wbGFjZVBpZWNlcygpO1xuXHQgICAgICAgICAgICB0aGlzLnBsYWNlU3BoZXJlKCk7XG5cdCAgICAgICAgfVxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogXCJwbGFjZVNwaGVyZVwiLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBwbGFjZVNwaGVyZSgpIHtcblx0ICAgICAgICAgICAgdmFyIGdlb21ldHJ5ID0gbmV3IFRIUkVFLlNwaGVyZUdlb21ldHJ5KDUwLCAxNiwgOCk7XG5cdCAgICAgICAgICAgIGdlb21ldHJ5LnNjYWxlKC0xLCAxLCAxKTtcblx0ICAgICAgICAgICAgLy8gZ2VvbWV0cnkuc2NhbGUoIC0gMSwgMSwgMSApO1xuXHQgICAgICAgICAgICAvLyB2YXIgc3BoZXJlID0gcmVxdWlyZShcIi4uLy4uL3B1YmxpYy9pbWFnZXMvc3BoZXJlICgyKS5qcGdcIilcblx0ICAgICAgICAgICAgdmFyIGxvYWRlciA9IG5ldyBUSFJFRS5UZXh0dXJlTG9hZGVyKCk7XG5cdCAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcblx0ICAgICAgICAgICAgbG9hZGVyLmxvYWQoXCJwdWJsaWMvaW1hZ2VzL3NwaGVyZSAoMikuanBnXCIsIGZ1bmN0aW9uICh0ZXh0dXJlKSB7XG5cdCAgICAgICAgICAgICAgICB2YXIgbWF0ZXJpYWwgPSBuZXcgVEhSRUUuTWVzaEJhc2ljTWF0ZXJpYWwoe1xuXHQgICAgICAgICAgICAgICAgICAgIG1hcDogdGV4dHVyZVxuXHQgICAgICAgICAgICAgICAgfSk7XG5cdFxuXHQgICAgICAgICAgICAgICAgdmFyIG1lc2ggPSBuZXcgVEhSRUUuTWVzaChnZW9tZXRyeSwgbWF0ZXJpYWwpO1xuXHQgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2cobWVzaClcblx0ICAgICAgICAgICAgICAgIG1lc2gucG9zaXRpb24uc2V0KDAsIDAsIDEwKTtcblx0ICAgICAgICAgICAgICAgIHNlbGYuc2NlbmUuYWRkKG1lc2gpO1xuXHQgICAgICAgICAgICB9KTtcblx0ICAgICAgICB9XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiBcInBsYWNlUGllY2VzXCIsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHBsYWNlUGllY2VzKCkge1xuXHRcblx0ICAgICAgICAgICAgdGhpcy5jb2x1bW5OdW1iZXIgPSA0O1xuXHQgICAgICAgICAgICB0aGlzLnBpZWNlTnVtYmVyID0gdGhpcy5jb2x1bW5OdW1iZXIgKiB0aGlzLmNvbHVtbk51bWJlcjtcblx0ICAgICAgICAgICAgdGhpcy5zY2FsZWRXaWR0aCA9IDE2O1xuXHQgICAgICAgICAgICB0aGlzLnNjYWxlZEhlaWdodCA9IDk7XG5cdCAgICAgICAgICAgIHRoaXMuZnJlZVBpZWNlTnVtYmVyID0gdGhpcy5waWVjZU51bWJlciAqIDEgLyAyO1xuXHQgICAgICAgICAgICB0aGlzLmZyZWVQaWVjZUxpc3QgPSBbXTtcblx0ICAgICAgICAgICAgdGhpcy5wbGFuZVdpZHRoID0gdGhpcy5zY2FsZWRXaWR0aCAvIHRoaXMuY29sdW1uTnVtYmVyO1xuXHQgICAgICAgICAgICB0aGlzLnBsYW5lSGVpZ2h0ID0gdGhpcy5zY2FsZWRIZWlnaHQgLyB0aGlzLmNvbHVtbk51bWJlcjtcblx0ICAgICAgICAgICAgdGhpcy5zZWxlY3RlZE1lc2ggPSBudWxsOyAvL3RoZSBsYXN0IGNsaWNrZWQgbWVzaElkXG5cdCAgICAgICAgICAgIHRoaXMuaG9sZE1hcCA9IHt9O1xuXHQgICAgICAgICAgICB0aGlzLm1lc2hDYW52YXNNYXAgPSB7fTtcblx0ICAgICAgICAgICAgLy8gdGhpcy5cblx0ICAgICAgICAgICAgLy8gbG9hZCBhbiBpbWFnZVxuXHQgICAgICAgICAgICB2YXIgaW1hZ2VPYmogPSBuZXcgSW1hZ2UoKTtcblx0ICAgICAgICAgICAgaW1hZ2VPYmouc3JjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTtcblx0ICAgICAgICAgICAgdmFyIGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIik7XG5cdCAgICAgICAgICAgIHZhciBjb250ZXh0ID0gY2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcblx0XG5cdCAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMucGllY2VXaWR0aCx0aGlzLnBpZWNlSGVpZ2h0KVxuXHQgICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG5cdCAgICAgICAgICAgIGltYWdlT2JqLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgICAgIHZhciB3cyA9IGNhbnZhcy53aWR0aCAvIDEuNSAvIGltYWdlT2JqLndpZHRoO1xuXHQgICAgICAgICAgICAgICAgdmFyIGhzID0gY2FudmFzLmhlaWdodCAvIDEuNSAvIGltYWdlT2JqLmhlaWdodDtcblx0ICAgICAgICAgICAgICAgIHNlbGYuc2NhbGUgPSBNYXRoLm1pbih3cywgaHMpO1xuXHQgICAgICAgICAgICAgICAgc2VsZi5waWVjZVdpZHRoID0gaW1hZ2VPYmoud2lkdGggLyBzZWxmLmNvbHVtbk51bWJlcjtcblx0ICAgICAgICAgICAgICAgIHNlbGYucGllY2VIZWlnaHQgPSBpbWFnZU9iai5oZWlnaHQgLyBzZWxmLmNvbHVtbk51bWJlcjtcblx0ICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBpbmRleCA9IDAsIHRleHR1cmUsIG1hdGVyaWFsLCBtZXNoOyBpIDwgc2VsZi5jb2x1bW5OdW1iZXI7IGkrKykge1xuXHQgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2VsZi5jb2x1bW5OdW1iZXI7IGorKywgaW5kZXgrKykge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0ID0gY2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgdGV4dHVyZSA9IG5ldyBUSFJFRS5UZXh0dXJlKGNhbnZhcyk7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQuZHJhd0ltYWdlKGltYWdlT2JqLCBpICogc2VsZi5waWVjZVdpZHRoLCBqICogc2VsZi5waWVjZUhlaWdodCwgc2VsZi5waWVjZVdpZHRoLCBzZWxmLnBpZWNlSGVpZ2h0LCAwLCAwLCBjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQpO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGV4dHVyZSkgLy8gY2hlY2tzIGlmIHRleHR1cmUgZXhpc3RzXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0dXJlLm5lZWRzVXBkYXRlID0gdHJ1ZTtcblx0XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIG1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hCYXNpY01hdGVyaWFsKHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcDogdGV4dHVyZSxcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpZGU6IFRIUkVFLkRvdWJsZVNpZGVcblx0ICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIG1hdGVyaWFsLnRyYW5zcGFyZW50ID0gZmFsc2U7XG5cdFxuXHQgICAgICAgICAgICAgICAgICAgICAgICBtZXNoID0gbmV3IFRIUkVFLk1lc2gobmV3IFRIUkVFLlBsYW5lR2VvbWV0cnkoc2VsZi5wbGFuZVdpZHRoLCBzZWxmLnBsYW5lSGVpZ2h0KSwgbWF0ZXJpYWwpO1xuXHRcblx0ICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJhbmRvbSA9IE1hdGgucmFuZG9tKCk7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyYW5kb20gPCBzZWxmLmZyZWVQaWVjZU51bWJlciAvIChzZWxmLmNvbHVtbk51bWJlciAqIHNlbGYuY29sdW1uTnVtYmVyIC0gaW5kZXgpICYmIHNlbGYuZnJlZVBpZWNlTnVtYmVyID4gMCkge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHggPSAtc2VsZi5ib3hTaXplIC8gMiArIHNlbGYucGxhbmVXaWR0aCAvIDIgKyBNYXRoLnJhbmRvbSgpICogKHNlbGYuYm94U2l6ZSAtIHNlbGYucGxhbmVXaWR0aCk7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgeiA9IC1zZWxmLmJveFNpemUgLyAyICsgc2VsZi5wbGFuZUhlaWdodCAvIDIgKyBNYXRoLnJhbmRvbSgpICogKHNlbGYuYm94U2l6ZSAtIHNlbGYucGxhbmVIZWlnaHQpO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzaC5yb3RhdGlvbi54ID0gTWF0aC5QSSAvIDI7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNoLnBvc2l0aW9uLnNldChNYXRoLnJvdW5kKHgpLCAwLjUsIE1hdGgucm91bmQoeikpO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGJsYW5rTWVzaCA9IG1lc2guY2xvbmUoKTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuaG9sZE1hcFttZXNoLmlkXSA9IGJsYW5rTWVzaDtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsYW5rTWVzaC5yb3RhdGlvbi54ID0gMDtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsYW5rTWVzaC5tYXRlcmlhbCA9IG5ldyBUSFJFRS5NZXNoQmFzaWNNYXRlcmlhbCh7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6IDB4ODA4MDgwLFxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpZGU6IFRIUkVFLkRvdWJsZVNpZGVcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxhbmtNZXNoLnBvc2l0aW9uLnNldChpICogc2VsZi5wbGFuZVdpZHRoIC0gc2VsZi5zY2FsZWRXaWR0aCAvIDIgKyBzZWxmLnBsYW5lV2lkdGggLyAyLCA1ICsgc2VsZi5zY2FsZWRIZWlnaHQgLSBzZWxmLnBsYW5lSGVpZ2h0IC8gMiAtIGogKiBzZWxmLnBsYW5lSGVpZ2h0LCAtOS45OSk7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnNjZW5lLmFkZChibGFua01lc2gpO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5mcmVlUGllY2VOdW1iZXItLTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuZnJlZVBpZWNlTGlzdC5wdXNoKG1lc2guaWQpO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5tZXNoQ2FudmFzTWFwW21lc2guaWRdID0gY2FudmFzO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzaC5wb3NpdGlvbi5zZXQoaSAqIHNlbGYucGxhbmVXaWR0aCAtIHNlbGYuc2NhbGVkV2lkdGggLyAyICsgc2VsZi5wbGFuZVdpZHRoIC8gMiwgNSArIHNlbGYuc2NhbGVkSGVpZ2h0IC0gc2VsZi5wbGFuZUhlaWdodCAvIDIgLSBqICogc2VsZi5wbGFuZUhlaWdodCwgLTkuOTkpO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIC8vIG1lc2gucG9zaXRpb24uc2V0KDAsIDIsLTkpXG5cdCAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYubWVzaExpc3QucHVzaChtZXNoKTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5zY2VuZS5hZGQobWVzaCk7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHR5cGVvZiB0aGlzLnNjZW5lKVxuXHQgICAgICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgfTtcblx0ICAgICAgICAgICAgLy8gc3dhbCh7XG5cdCAgICAgICAgICAgIC8vICAgICB0aXRsZTogXCLmj5DnpLpcIixcblx0ICAgICAgICAgICAgLy8gICAgIHRleHQ6IFwi5oqK5bGP5bmV5Lit5aSu55qE5bCP5omL5a+55YeG5Zyw5LiK55qE5Zu+54mH77yM54K55Ye75oyJ6ZKu5o2h6LW377yM5YaN5oqK5Zu+54mH5a+55YeG5Y6f5Zu+5L2N572u77yM54K55Ye76LS05LiKXCIsXG5cdCAgICAgICAgICAgIC8vICAgICBjb25maXJtQnV0dG9uVGV4dDogXCLlpb3nmoRcIlxuXHQgICAgICAgICAgICAvLyB9KVxuXHQgICAgICAgIH1cblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6IFwicmVuZGVyXCIsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcih0aW1lc3RhbXApIHtcblx0ICAgICAgICAgICAgLy8gdmFyIGRlbHRhID0gTWF0aC5taW4odGltZXN0YW1wIC0gdGhpcy5sYXN0UmVuZGVyLCA1MDApXG5cdCAgICAgICAgICAgIHRoaXMubGFzdFJlbmRlciA9IHRpbWVzdGFtcDtcblx0ICAgICAgICAgICAgLy/lpITnkIbpvKDmoIfngrnlh7tcblx0ICAgICAgICAgICAgdGhpcy5yYXljYXN0ZXIuc2V0RnJvbUNhbWVyYSh0aGlzLm1vdXNlLCB0aGlzLmNhbWVyYSk7XG5cdCAgICAgICAgICAgIHZhciBpbnRlcnNlY3RzID0gdGhpcy5yYXljYXN0ZXIuaW50ZXJzZWN0T2JqZWN0cyh0aGlzLnNjZW5lLmNoaWxkcmVuKTtcblx0ICAgICAgICAgICAgdGhpcy5tb3VzZS54ID0gdGhpcy5tb3VzZS55ID0gdW5kZWZpbmVkO1xuXHQgICAgICAgICAgICBpZiAoaW50ZXJzZWN0cy5sZW5ndGggPiAwKSB7XG5cdCAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhpbnRlcnNlY3RzKVxuXHQgICAgICAgICAgICAgICAgdmFyIGNsaWNrRmxhZyA9IGZhbHNlO1xuXHQgICAgICAgICAgICAgICAgdmFyIF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24gPSB0cnVlO1xuXHQgICAgICAgICAgICAgICAgdmFyIF9kaWRJdGVyYXRvckVycm9yID0gZmFsc2U7XG5cdCAgICAgICAgICAgICAgICB2YXIgX2l0ZXJhdG9yRXJyb3IgPSB1bmRlZmluZWQ7XG5cdFxuXHQgICAgICAgICAgICAgICAgdHJ5IHtcblx0ICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBfaXRlcmF0b3IgPSB0aGlzLm1lc2hMaXN0W1N5bWJvbC5pdGVyYXRvcl0oKSwgX3N0ZXA7ICEoX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiA9IChfc3RlcCA9IF9pdGVyYXRvci5uZXh0KCkpLmRvbmUpOyBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uID0gdHJ1ZSkge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbWVzaCA9IF9zdGVwLnZhbHVlO1xuXHRcblx0XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmZyZWVQaWVjZUxpc3QuaW5kZXhPZihtZXNoLmlkKSA+IC0xICYmIG1lc2guaWQgPT0gaW50ZXJzZWN0c1swXS5vYmplY3QuaWQpIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG1lc2gubWF0ZXJpYWwuY29sb3Iuc2V0KDB4ZmYwMDAwKVxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coMSk7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5zZWxlY3RlZE1lc2ggIT09IG51bGwpIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNsZWFyQ2FudmFzKCk7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZE1lc2gudmlzaWJsZSA9IHRydWU7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkTWVzaCA9IG1lc2g7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygyKTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubW91c2UucGlja0J0bi5pbm5lckhUTUwgPSBcIui0tOS4ilwiO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xpY2tGbGFnID0gdHJ1ZTtcblx0XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNoLnZpc2libGUgPSBmYWxzZTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicGluXCIpLmFwcGVuZENoaWxkKHRoaXMubWVzaENhbnZhc01hcFttZXNoLmlkXSk7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygzKTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xuXHQgICAgICAgICAgICAgICAgICAgIF9kaWRJdGVyYXRvckVycm9yID0gdHJ1ZTtcblx0ICAgICAgICAgICAgICAgICAgICBfaXRlcmF0b3JFcnJvciA9IGVycjtcblx0ICAgICAgICAgICAgICAgIH0gZmluYWxseSB7XG5cdCAgICAgICAgICAgICAgICAgICAgdHJ5IHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uICYmIF9pdGVyYXRvci5yZXR1cm4pIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pdGVyYXRvci5yZXR1cm4oKTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgICAgIH0gZmluYWxseSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfZGlkSXRlcmF0b3JFcnJvcikge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgX2l0ZXJhdG9yRXJyb3I7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRNZXNoICYmIHRoaXMuaG9sZE1hcFt0aGlzLnNlbGVjdGVkTWVzaC5pZF0uaWQgPT0gaW50ZXJzZWN0c1swXS5vYmplY3QuaWQpIHtcblx0ICAgICAgICAgICAgICAgICAgICB2YXIgdCA9IGludGVyc2VjdHNbMF0ub2JqZWN0LnBvc2l0aW9uO1xuXHQgICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRNZXNoLnBvc2l0aW9uLnNldCh0LngsIHQueSwgdC56KTtcblx0ICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkTWVzaC5yb3RhdGlvbi5zZXQoMCwgMCwgMCk7XG5cdCAgICAgICAgICAgICAgICAgICAgdGhpcy5ob2xkTWFwW3RoaXMuc2VsZWN0ZWRNZXNoLmlkXS5wb3NpdGlvbi56IC09IDE7XG5cdCAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZE1lc2gudmlzaWJsZSA9IHRydWU7XG5cdCAgICAgICAgICAgICAgICAgICAgdGhpcy5tb3VzZS5waWNrQnRuLmlubmVySFRNTCA9IFwi5o2h6LW3XCI7XG5cdCAgICAgICAgICAgICAgICAgICAgLy/lnKjmnKrmi7zmiJDlm77niYfliJfooajkuK3lj5blh7rlvZPliY3poblcblx0ICAgICAgICAgICAgICAgICAgICB0aGlzLmZyZWVQaWVjZUxpc3Quc3BsaWNlKHRoaXMuZnJlZVBpZWNlTGlzdC5pbmRleE9mKHRoaXMuc2VsZWN0ZWRNZXNoLmlkKSwgMSk7XG5cdCAgICAgICAgICAgICAgICAgICAgLy/muIXmpZrlvZPliY3pgInlj5bnmoTlm77lg49cblx0ICAgICAgICAgICAgICAgICAgICB0aGlzLmNsZWFyQ2FudmFzKCk7XG5cdCAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZE1lc2ggPSBudWxsO1xuXHQgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmZyZWVQaWVjZUxpc3QubGVuZ3RoID09IDApIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgKDAsIF9zd2VldGFsZXJ0Mi5kZWZhdWx0KSh7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogXCLmga3llpzvvIFcIixcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IFwi5oiQ5Yqf5ou85a6M5LqG5LiA5byg5Zu+77yM5Y+v5piv5oiR5Lmf5LiN5Lya57uZ5L2g5rWB6YePXCIsXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogXCLlpb3nmoRcIlxuXHQgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblx0ICAgICAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICBpZiAodGhpcy5zZWxlY3RlZE1lc2ggJiYgIWNsaWNrRmxhZykge1xuXHQgICAgICAgICAgICAgICAgICAgIHRoaXMubW91c2UucGlja0J0bi5pbm5lckhUTUwgPSBcIuaNoei1t1wiO1xuXHQgICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRNZXNoLnZpc2libGUgPSB0cnVlO1xuXHQgICAgICAgICAgICAgICAgICAgIHRoaXMuY2xlYXJDYW52YXMoKTtcblx0ICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkTWVzaCA9IG51bGw7XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICAgIHRoaXMuY29udHJvbHMudXBkYXRlKCk7XG5cdCAgICAgICAgICAgIHRoaXMucmVuZGVyZXIucmVuZGVyKHRoaXMuc2NlbmUsIHRoaXMuY2FtZXJhKTtcblx0XG5cdCAgICAgICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLnJlbmRlcik7XG5cdCAgICAgICAgfVxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogXCJvblJlc2l6ZVwiLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBvblJlc2l6ZShlKSB7XG5cdCAgICAgICAgICAgIHRoaXMuY2FtZXJhLmFzcGVjdCA9IHdpbmRvdy5pbm5lcldpZHRoIC8gd2luZG93LmlubmVySGVpZ2h0O1xuXHQgICAgICAgICAgICB0aGlzLmNhbWVyYS51cGRhdGVQcm9qZWN0aW9uTWF0cml4KCk7XG5cdCAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuc2V0U2l6ZSh3aW5kb3cuaW5uZXJXaWR0aCwgd2luZG93LmlubmVySGVpZ2h0KTtcblx0ICAgICAgICB9XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiBcImNsZWFyQ2FudmFzXCIsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNsZWFyQ2FudmFzKCkge1xuXHQgICAgICAgICAgICB2YXIgY2FudmFzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwaW4gY2FudmFzXCIpO1xuXHQgICAgICAgICAgICB2YXIgcGluID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwaW5cIik7XG5cdCAgICAgICAgICAgIHdoaWxlIChjYW52YXMgIT0gbnVsbCkge1xuXHQgICAgICAgICAgICAgICAgcGluLnJlbW92ZUNoaWxkKGNhbnZhcyk7XG5cdCAgICAgICAgICAgICAgICBjYW52YXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3BpbiBjYW52YXNcIik7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdCAgICB9XSk7XG5cdFxuXHQgICAgcmV0dXJuIEdhbWU7XG5cdH0oKTtcblx0XG5cdGV4cG9ydHMuZGVmYXVsdCA9IEdhbWU7XG5cbi8qKiovIH0sXG4vKiAyICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHRcInVzZSBzdHJpY3RcIjtcblx0XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuXHQgICAgdmFsdWU6IHRydWVcblx0fSk7XG5cdFxuXHR2YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXHRcblx0ZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblx0XG5cdGZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKCFzZWxmKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikgPyBjYWxsIDogc2VsZjsgfVxuXHRcblx0ZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cdFxuXHR2YXIgTW91c2UgPSBmdW5jdGlvbiAoX1RIUkVFJFZlY3Rvcikge1xuXHQgICAgX2luaGVyaXRzKE1vdXNlLCBfVEhSRUUkVmVjdG9yKTtcblx0XG5cdCAgICBmdW5jdGlvbiBNb3VzZShwcm9wcykge1xuXHQgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBNb3VzZSk7XG5cdFxuXHQgICAgICAgIHZhciBfdGhpcyA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIE9iamVjdC5nZXRQcm90b3R5cGVPZihNb3VzZSkuY2FsbCh0aGlzLCBwcm9wcykpO1xuXHRcblx0ICAgICAgICBfdGhpcy54ID0gdW5kZWZpbmVkO1xuXHQgICAgICAgIF90aGlzLnkgPSB1bmRlZmluZWQ7XG5cdCAgICAgICAgLy8gd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoIFwiY2xpY2tcIiwgdGhpcy5vbk1vdXNlQ2xpY2suYmluZCh0aGlzKSwgZmFsc2UgKVxuXHQgICAgICAgIF90aGlzLnBpY2tCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBpY2stYnRuXCIpO1xuXHQgICAgICAgIF90aGlzLnBpY2tIYW5kID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwaWNrLWhhbmRcIik7XG5cdCAgICAgICAgX3RoaXMucGlja0J0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgX3RoaXMuYnRuT25DbGljay5iaW5kKF90aGlzKSwgZmFsc2UpO1xuXHQgICAgICAgIC8vIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIix0aGlzLm9uTW91c2VDbGljay5iaW5kKHRoaXMpLGZhbHNlKVxuXHQgICAgICAgIHJldHVybiBfdGhpcztcblx0ICAgIH1cblx0XG5cdCAgICBfY3JlYXRlQ2xhc3MoTW91c2UsIFt7XG5cdCAgICAgICAga2V5OiBcIm9uTW91c2VDbGlja1wiLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBvbk1vdXNlQ2xpY2soZXZlbnQpIHtcblx0ICAgICAgICAgICAgLy8gY2FsY3VsYXRlIG1vdXNlIHBvc2l0aW9uIGluIG5vcm1hbGl6ZWQgZGV2aWNlIGNvb3JkaW5hdGVzXG5cdCAgICAgICAgICAgIC8vICgtMSB0byArMSkgZm9yIGJvdGggY29tcG9uZW50c1xuXHQgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhldmVudC5jbGllbnRYLGV2ZW50LmNsaWVudFkpXG5cdCAgICAgICAgICAgIHRoaXMueCA9IGV2ZW50LmNsaWVudFggLyB3aW5kb3cuaW5uZXJXaWR0aCAqIDIgLSAxO1xuXHQgICAgICAgICAgICB0aGlzLnkgPSAtKGV2ZW50LmNsaWVudFkgLyB3aW5kb3cuaW5uZXJIZWlnaHQpICogMiArIDE7XG5cdCAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMueCx0aGlzLnkpXG5cdCAgICAgICAgfVxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogXCJidG5PbkNsaWNrXCIsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGJ0bk9uQ2xpY2soZXZlbnQpIHtcblx0ICAgICAgICAgICAgdGhpcy54ID0gMC40NiAqIDIgLSAxO1xuXHQgICAgICAgICAgICB0aGlzLnkgPSAtMC4zOTUgKiAyICsgMTtcblx0ICAgICAgICAgICAgLy8gY29uc29sZS5sb2codGhpcy54LHRoaXMueSlcblx0ICAgICAgICB9XG5cdCAgICB9XSk7XG5cdFxuXHQgICAgcmV0dXJuIE1vdXNlO1xuXHR9KFRIUkVFLlZlY3RvcjIpO1xuXHRcblx0ZXhwb3J0cy5kZWZhdWx0ID0gTW91c2U7XG5cbi8qKiovIH0sXG4vKiAzICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHRtb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18ucCArIFwiaW1hZ2VzL3B1enpsZXMvY2FydG9vbiAoMykuanBnXCI7XG5cbi8qKiovIH0sXG4vKiA0ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHRtb2R1bGUuZXhwb3J0cyA9IHN3YWw7XG5cbi8qKiovIH0sXG4vKiA1ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHRtb2R1bGUuZXhwb3J0cyA9IHRydWU7XG5cbi8qKiovIH1cbi8qKioqKiovIF0pO1xuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIFZSUHV6emxlLmJ1bmRsZS5qc1xuICoqLyIsIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKVxuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuXG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRleHBvcnRzOiB7fSxcbiBcdFx0XHRpZDogbW9kdWxlSWQsXG4gXHRcdFx0bG9hZGVkOiBmYWxzZVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sb2FkZWQgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIi9WUlB1enpsZS9wdWJsaWMvXCI7XG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oMCk7XG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiB3ZWJwYWNrL2Jvb3RzdHJhcCBiMGRhYmVjMDhmMzIyYzgwNDYwNlxuICoqLyIsImltcG9ydCAnYmFiZWwtcG9seWZpbGwnO1xyXG5pbXBvcnQgR2FtZSBmcm9tIFwiLi9nYW1lLmpzXCJcclxubGV0IGdhbWUgPSBuZXcgR2FtZSgpXHJcblxyXG5jb25zdCBsb29wID0gKCk9PntcclxuICAgIGdhbWUucmVuZGVyKClcclxuICAgIC8vIHJlcXVlc3RBbmltYXRpb25GcmFtZShsb29wKVxyXG59XHJcbmxvb3AoKVxyXG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL3NyYy9qYXZhc2NyaXB0cy9pbmRleC5qc1xuICoqLyIsIlxyXG5pbXBvcnQgTW91c2UgZnJvbSBcIi4vbW91c2UuanNcIlxyXG5pbXBvcnQgc3dhbCBmcm9tIFwic3dlZXRhbGVydFwiXHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBHYW1lIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIC8vIENyZWF0ZSBhIHRocmVlLmpzIHNjZW5lLlxyXG4gICAgICAgIHRoaXMuc2NlbmUgPSBuZXcgVEhSRUUuU2NlbmUoKVxyXG5cclxuICAgICAgICAvLyBDcmVhdGUgYSB0aHJlZS5qcyBjYW1lcmEuXHJcbiAgICAgICAgdGhpcy5jYW1lcmEgPSBuZXcgVEhSRUUuUGVyc3BlY3RpdmVDYW1lcmEoNzUsIHdpbmRvdy5pbm5lcldpZHRoIC8gd2luZG93LmlubmVySGVpZ2h0LCAwLjEsIDEwMDAwKVxyXG5cclxuICAgICAgICB0aGlzLmNhbWVyYS5wb3NpdGlvbi5zZXQoMCwxMCwwKVxyXG4gICAgICAgIHRoaXMuY29udHJvbHMgPSBuZXcgVEhSRUUuRGV2aWNlT3JpZW50YXRpb25Db250cm9scyggdGhpcy5jYW1lcmEgKTtcclxuXHJcbiAgICAgICAgdGhpcy5yZW5kZXJlciA9IG5ldyBUSFJFRS5XZWJHTFJlbmRlcmVyKHtcclxuICAgICAgICAgICAgYW50aWFsaWFzOiB0cnVlXHJcbiAgICAgICAgfSk7XHJcblx0XHR0aGlzLnJlbmRlcmVyLnNldFBpeGVsUmF0aW8oIHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvICk7XHJcblx0XHR0aGlzLnJlbmRlcmVyLnNldFNpemUod2luZG93LmlubmVyV2lkdGgsIHdpbmRvdy5pbm5lckhlaWdodCk7XHJcblx0XHR0aGlzLnJlbmRlcmVyLmRvbUVsZW1lbnQuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnO1xyXG5cdFx0dGhpcy5yZW5kZXJlci5kb21FbGVtZW50LnN0eWxlLnRvcCA9IDA7XHJcblx0XHRkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRoaXMucmVuZGVyZXIuZG9tRWxlbWVudCk7XHJcblxyXG4gICAgICAgIC8vIHJheWNhc3RlclxyXG4gICAgICAgIHRoaXMucmF5Y2FzdGVyID0gbmV3IFRIUkVFLlJheWNhc3RlcigpXHJcbiAgICAgICAgdGhpcy5tb3VzZSA9IG5ldyBNb3VzZSgpXHJcbiAgICAgICAgICAgIC8vYmluZCB0aGlzXHJcbiAgICAgICAgdGhpcy5vblRleHR1cmVMb2FkZWQgPSB0aGlzLm9uVGV4dHVyZUxvYWRlZC5iaW5kKHRoaXMpXHJcbiAgICAgICAgdGhpcy5vblJlc2l6ZSA9IHRoaXMub25SZXNpemUuYmluZCh0aGlzKVxyXG4gICAgICAgIHRoaXMucmVuZGVyID0gdGhpcy5yZW5kZXIuYmluZCh0aGlzKVxyXG4gICAgICAgIHRoaXMucGxhY2VQaWVjZXMgPSB0aGlzLnBsYWNlUGllY2VzLmJpbmQodGhpcylcclxuICAgICAgICAgICAgLy9cclxuICAgICAgICB0aGlzLm1lc2hMaXN0ID0gW11cclxuICAgICAgICB0aGlzLmxvZ0ZsYWcgPSB0cnVlXHJcbiAgICAgICAgICAgIC8vIEFkZCBhIHJlcGVhdGluZyBncmlkIGFzIGEgc2t5Ym94LlxyXG4gICAgICAgIHRoaXMuYm94U2l6ZSA9IDMwXHJcbiAgICAgICAgLy8gdGhpcy5sb2FkZXIgPSBuZXcgVEhSRUUuVGV4dHVyZUxvYWRlcigpXHJcbiAgICAgICAgLy8gdGhpcy5sb2FkZXIubG9hZChcInB1YmxpYy9pbWFnZXMvYm94LnBuZ1wiLCB0aGlzLm9uVGV4dHVyZUxvYWRlZClcclxuICAgICAgICAvLyBsZXQgdGV4dHVyZSA9IG5ldyBUSFJFRS5UZXh0dXJlKClcclxuICAgICAgICB0aGlzLm9uVGV4dHVyZUxvYWRlZCgpXHJcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJyZXNpemVcIiwgdGhpcy5vblJlc2l6ZSwgdHJ1ZSlcclxuICAgICAgICAvLyB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInZyZGlzcGxheXByZXNlbnRjaGFuZ2VcIiwgdGhpcy5vblJlc2l6ZSwgdHJ1ZSlcclxuICAgICAgICB0aGlzLmxhc3RSZW5kZXIgPSAwXHJcbiAgICAgICAgdGhpcy5kaXNwbGF5ID0gbnVsbFxyXG4gICAgfVxyXG4gICAgb25UZXh0dXJlTG9hZGVkKCkge1xyXG4gICAgICAgIC8vIHRleHR1cmUud3JhcFMgPSBUSFJFRS5SZXBlYXRXcmFwcGluZ1xyXG4gICAgICAgIC8vIHRleHR1cmUud3JhcFQgPSBUSFJFRS5SZXBlYXRXcmFwcGluZ1xyXG4gICAgICAgIC8vIHRleHR1cmUucmVwZWF0LnNldCh0aGlzLmJveFNpemUsIHRoaXMuYm94U2l6ZSlcclxuXHJcbiAgICAgICAgbGV0IGdlb21ldHJ5ID0gbmV3IFRIUkVFLkJveEdlb21ldHJ5KHRoaXMuYm94U2l6ZSwgdGhpcy5ib3hTaXplLCB0aGlzLmJveFNpemUpXHJcbiAgICAgICAgbGV0IG1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hCYXNpY01hdGVyaWFsKHsgY29sb3I6IDB4ZmYwMGZmLCBzaWRlOiBUSFJFRS5CYWNrU2lkZSwgd2lyZWZyYW1lOiB0cnVlIH0gKVxyXG5cclxuICAgICAgICAvLyBBbGlnbiB0aGUgc2t5Ym94IHRvIHRoZSBmbG9vciAod2hpY2ggaXMgYXQgeT0wKS5cclxuICAgICAgICB0aGlzLnNreWJveCA9IG5ldyBUSFJFRS5NZXNoKGdlb21ldHJ5LCBtYXRlcmlhbClcclxuICAgICAgICB0aGlzLnNreWJveC5wb3NpdGlvbi55ID0gdGhpcy5ib3hTaXplIC8gMlxyXG4gICAgICAgIHRoaXMuc2NlbmUuYWRkKHRoaXMuc2t5Ym94KVxyXG4gICAgICAgIHRoaXMucGxhY2VQaWVjZXMoKVxyXG4gICAgICAgIHRoaXMucGxhY2VTcGhlcmUoKVxyXG4gICAgfVxyXG4gICAgcGxhY2VTcGhlcmUoKXtcclxuICAgICAgICB2YXIgZ2VvbWV0cnkgPSBuZXcgVEhSRUUuU3BoZXJlR2VvbWV0cnkoIDUwLCAxNiwgOCApO1xyXG4gICAgICAgIGdlb21ldHJ5LnNjYWxlKC0xLDEsMSlcclxuXHRcdC8vIGdlb21ldHJ5LnNjYWxlKCAtIDEsIDEsIDEgKTtcclxuICAgICAgICAvLyB2YXIgc3BoZXJlID0gcmVxdWlyZShcIi4uLy4uL3B1YmxpYy9pbWFnZXMvc3BoZXJlICgyKS5qcGdcIilcclxuICAgICAgICB2YXIgbG9hZGVyID0gbmV3IFRIUkVFLlRleHR1cmVMb2FkZXIoKVxyXG4gICAgICAgIHZhciBzZWxmID0gdGhpc1xyXG4gICAgICAgIGxvYWRlci5sb2FkKFwicHVibGljL2ltYWdlcy9zcGhlcmUgKDIpLmpwZ1wiLGZ1bmN0aW9uKHRleHR1cmUpe1xyXG4gICAgICAgICAgICB2YXIgbWF0ZXJpYWwgPSBuZXcgVEhSRUUuTWVzaEJhc2ljTWF0ZXJpYWwoIHtcclxuICAgIFx0XHRcdG1hcDogdGV4dHVyZVxyXG4gICAgXHRcdH0gKTtcclxuXHJcbiAgICBcdFx0dmFyIG1lc2ggPSBuZXcgVEhSRUUuTWVzaCggZ2VvbWV0cnksIG1hdGVyaWFsICk7XHJcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKG1lc2gpXHJcbiAgICAgICAgICAgIG1lc2gucG9zaXRpb24uc2V0KDAsMCwxMClcclxuICAgIFx0XHRzZWxmLnNjZW5lLmFkZCggbWVzaCApO1xyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcbiAgICBwbGFjZVBpZWNlcygpIHtcclxuXHJcbiAgICAgICAgdGhpcy5jb2x1bW5OdW1iZXIgPSA0XHJcbiAgICAgICAgdGhpcy5waWVjZU51bWJlciA9IHRoaXMuY29sdW1uTnVtYmVyICogdGhpcy5jb2x1bW5OdW1iZXJcclxuICAgICAgICB0aGlzLnNjYWxlZFdpZHRoID0gMTZcclxuICAgICAgICB0aGlzLnNjYWxlZEhlaWdodCA9IDlcclxuICAgICAgICB0aGlzLmZyZWVQaWVjZU51bWJlciA9IHRoaXMucGllY2VOdW1iZXIgKiAxIC8gMlxyXG4gICAgICAgIHRoaXMuZnJlZVBpZWNlTGlzdCA9IFtdXHJcbiAgICAgICAgdGhpcy5wbGFuZVdpZHRoID0gdGhpcy5zY2FsZWRXaWR0aCAvIHRoaXMuY29sdW1uTnVtYmVyXHJcbiAgICAgICAgdGhpcy5wbGFuZUhlaWdodCA9IHRoaXMuc2NhbGVkSGVpZ2h0IC8gdGhpcy5jb2x1bW5OdW1iZXJcclxuICAgICAgICB0aGlzLnNlbGVjdGVkTWVzaCA9IG51bGwgLy90aGUgbGFzdCBjbGlja2VkIG1lc2hJZFxyXG4gICAgICAgIHRoaXMuaG9sZE1hcCA9IHt9XHJcbiAgICAgICAgdGhpcy5tZXNoQ2FudmFzTWFwID0ge31cclxuICAgICAgICAvLyB0aGlzLlxyXG4gICAgICAgICAgICAvLyBsb2FkIGFuIGltYWdlXHJcbiAgICAgICAgbGV0IGltYWdlT2JqID0gbmV3IEltYWdlKClcclxuICAgICAgICBpbWFnZU9iai5zcmMgPSByZXF1aXJlKFwiLi4vLi4vcHVibGljL2ltYWdlcy9wdXp6bGVzL2NhcnRvb24gKDMpLmpwZ1wiKVxyXG4gICAgICAgIGxldCBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpXHJcbiAgICAgICAgbGV0IGNvbnRleHQgPSBjYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpXHJcblxyXG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLnBpZWNlV2lkdGgsdGhpcy5waWVjZUhlaWdodClcclxuICAgICAgICBsZXQgc2VsZiA9IHRoaXNcclxuICAgICAgICBpbWFnZU9iai5vbmxvYWQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgbGV0IHdzID0gKGNhbnZhcy53aWR0aCAvIDEuNSkgLyBpbWFnZU9iai53aWR0aFxyXG4gICAgICAgICAgICBsZXQgaHMgPSAoY2FudmFzLmhlaWdodCAvIDEuNSkgLyBpbWFnZU9iai5oZWlnaHRcclxuICAgICAgICAgICAgc2VsZi5zY2FsZSA9IE1hdGgubWluKHdzLCBocylcclxuICAgICAgICAgICAgc2VsZi5waWVjZVdpZHRoID0gaW1hZ2VPYmoud2lkdGggLyBzZWxmLmNvbHVtbk51bWJlclxyXG4gICAgICAgICAgICBzZWxmLnBpZWNlSGVpZ2h0ID0gaW1hZ2VPYmouaGVpZ2h0IC8gc2VsZi5jb2x1bW5OdW1iZXJcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDAsIGluZGV4ID0gMCwgdGV4dHVyZSwgbWF0ZXJpYWwsIG1lc2g7IGkgPCBzZWxmLmNvbHVtbk51bWJlcjsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHNlbGYuY29sdW1uTnVtYmVyOyBqKyssIGluZGV4KyspIHtcclxuICAgICAgICAgICAgICAgICAgICBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIilcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0dXJlID0gbmV3IFRIUkVFLlRleHR1cmUoY2FudmFzKVxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHQuZHJhd0ltYWdlKGltYWdlT2JqLCBpICogc2VsZi5waWVjZVdpZHRoLCBqICogc2VsZi5waWVjZUhlaWdodCwgc2VsZi5waWVjZVdpZHRoLCBzZWxmLnBpZWNlSGVpZ2h0LCAwLCAwLCBjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQpXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRleHR1cmUpIC8vIGNoZWNrcyBpZiB0ZXh0dXJlIGV4aXN0c1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0dXJlLm5lZWRzVXBkYXRlID0gdHJ1ZVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBtYXRlcmlhbCA9IG5ldyBUSFJFRS5NZXNoQmFzaWNNYXRlcmlhbCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hcDogdGV4dHVyZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2lkZTogVEhSRUUuRG91YmxlU2lkZVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgbWF0ZXJpYWwudHJhbnNwYXJlbnQgPSBmYWxzZVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBtZXNoID0gbmV3IFRIUkVFLk1lc2goXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBUSFJFRS5QbGFuZUdlb21ldHJ5KHNlbGYucGxhbmVXaWR0aCwgc2VsZi5wbGFuZUhlaWdodCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hdGVyaWFsXHJcbiAgICAgICAgICAgICAgICAgICAgKVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBsZXQgcmFuZG9tID0gTWF0aC5yYW5kb20oKVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChyYW5kb20gPCBzZWxmLmZyZWVQaWVjZU51bWJlciAvIChzZWxmLmNvbHVtbk51bWJlciAqIHNlbGYuY29sdW1uTnVtYmVyIC0gaW5kZXgpICYmIHNlbGYuZnJlZVBpZWNlTnVtYmVyID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgeCA9IC1zZWxmLmJveFNpemUgLyAyICsgc2VsZi5wbGFuZVdpZHRoIC8gMiArIE1hdGgucmFuZG9tKCkgKiAoc2VsZi5ib3hTaXplIC0gc2VsZi5wbGFuZVdpZHRoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgeiA9IC1zZWxmLmJveFNpemUgLyAyICsgc2VsZi5wbGFuZUhlaWdodCAvIDIgKyBNYXRoLnJhbmRvbSgpICogKHNlbGYuYm94U2l6ZSAtIHNlbGYucGxhbmVIZWlnaHQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc2gucm90YXRpb24ueCA9IE1hdGguUEkgLyAyXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc2gucG9zaXRpb24uc2V0KE1hdGgucm91bmQoeCksIDAuNSwgTWF0aC5yb3VuZCh6KSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGJsYW5rTWVzaCA9IG1lc2guY2xvbmUoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmhvbGRNYXBbbWVzaC5pZF0gPSBibGFua01lc2hcclxuICAgICAgICAgICAgICAgICAgICAgICAgYmxhbmtNZXNoLnJvdGF0aW9uLnggPSAwXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsYW5rTWVzaC5tYXRlcmlhbCA9IG5ldyBUSFJFRS5NZXNoQmFzaWNNYXRlcmlhbCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogMHg4MDgwODAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaWRlOiBUSFJFRS5Eb3VibGVTaWRlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsYW5rTWVzaC5wb3NpdGlvbi5zZXQoaSpzZWxmLnBsYW5lV2lkdGggLSBzZWxmLnNjYWxlZFdpZHRoIC8gMiArIHNlbGYucGxhbmVXaWR0aCAvIDIsIDUgKyBzZWxmLnNjYWxlZEhlaWdodCAtIHNlbGYucGxhbmVIZWlnaHQgLyAyIC0gaiAqIHNlbGYucGxhbmVIZWlnaHQsIC05Ljk5KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnNjZW5lLmFkZChibGFua01lc2gpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuZnJlZVBpZWNlTnVtYmVyLS1cclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5mcmVlUGllY2VMaXN0LnB1c2gobWVzaC5pZClcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5tZXNoQ2FudmFzTWFwW21lc2guaWRdID0gY2FudmFzXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWVzaC5wb3NpdGlvbi5zZXQoaSAqIHNlbGYucGxhbmVXaWR0aCAtIHNlbGYuc2NhbGVkV2lkdGggLyAyICsgc2VsZi5wbGFuZVdpZHRoIC8gMiwgNSArIHNlbGYuc2NhbGVkSGVpZ2h0IC0gc2VsZi5wbGFuZUhlaWdodCAvIDIgLSBqICogc2VsZi5wbGFuZUhlaWdodCwgLTkuOTkpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIG1lc2gucG9zaXRpb24uc2V0KDAsIDIsLTkpXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5tZXNoTGlzdC5wdXNoKG1lc2gpXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5zY2VuZS5hZGQobWVzaClcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2codHlwZW9mIHRoaXMuc2NlbmUpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gc3dhbCh7XHJcbiAgICAgICAgLy8gICAgIHRpdGxlOiBcIuaPkOekulwiLFxyXG4gICAgICAgIC8vICAgICB0ZXh0OiBcIuaKiuWxj+W5leS4reWkrueahOWwj+aJi+WvueWHhuWcsOS4iueahOWbvueJh++8jOeCueWHu+aMiemSruaNoei1t++8jOWGjeaKiuWbvueJh+WvueWHhuWOn+WbvuS9jee9ru+8jOeCueWHu+i0tOS4ilwiLFxyXG4gICAgICAgIC8vICAgICBjb25maXJtQnV0dG9uVGV4dDogXCLlpb3nmoRcIlxyXG4gICAgICAgIC8vIH0pXHJcbiAgICB9XHJcbiAgICByZW5kZXIodGltZXN0YW1wKSB7XHJcbiAgICAgICAgLy8gdmFyIGRlbHRhID0gTWF0aC5taW4odGltZXN0YW1wIC0gdGhpcy5sYXN0UmVuZGVyLCA1MDApXHJcbiAgICAgICAgdGhpcy5sYXN0UmVuZGVyID0gdGltZXN0YW1wXHJcbiAgICAgICAgICAgIC8v5aSE55CG6byg5qCH54K55Ye7XHJcbiAgICAgICAgdGhpcy5yYXljYXN0ZXIuc2V0RnJvbUNhbWVyYSh0aGlzLm1vdXNlLCB0aGlzLmNhbWVyYSlcclxuICAgICAgICBsZXQgaW50ZXJzZWN0cyA9IHRoaXMucmF5Y2FzdGVyLmludGVyc2VjdE9iamVjdHModGhpcy5zY2VuZS5jaGlsZHJlbilcclxuICAgICAgICB0aGlzLm1vdXNlLnggPSB0aGlzLm1vdXNlLnkgPSB1bmRlZmluZWRcclxuICAgICAgICBpZiAoaW50ZXJzZWN0cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGludGVyc2VjdHMpXHJcbiAgICAgICAgICAgIGxldCBjbGlja0ZsYWcgPSBmYWxzZVxyXG4gICAgICAgICAgICBmb3IgKGxldCBtZXNoIG9mIHRoaXMubWVzaExpc3QpIHtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5mcmVlUGllY2VMaXN0LmluZGV4T2YobWVzaC5pZCkgPiAtMSAmJiBtZXNoLmlkID09IGludGVyc2VjdHNbMF0ub2JqZWN0LmlkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gbWVzaC5tYXRlcmlhbC5jb2xvci5zZXQoMHhmZjAwMDApXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coMSlcclxuICAgICAgICAgICAgICAgICAgICBpZih0aGlzLnNlbGVjdGVkTWVzaCE9PW51bGwpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNsZWFyQ2FudmFzKClcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZE1lc2gudmlzaWJsZSA9IHRydWVcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZE1lc2ggPSBtZXNoXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coMilcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm1vdXNlLnBpY2tCdG4uaW5uZXJIVE1MID0gXCLotLTkuIpcIlxyXG4gICAgICAgICAgICAgICAgICAgIGNsaWNrRmxhZyA9IHRydWVcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgbWVzaC52aXNpYmxlID0gZmFsc2VcclxuICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBpblwiKS5hcHBlbmRDaGlsZCh0aGlzLm1lc2hDYW52YXNNYXBbbWVzaC5pZF0pXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coMylcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZih0aGlzLnNlbGVjdGVkTWVzaCAmJiB0aGlzLmhvbGRNYXBbdGhpcy5zZWxlY3RlZE1lc2guaWRdLmlkID09IGludGVyc2VjdHNbMF0ub2JqZWN0LmlkKXtcclxuICAgICAgICAgICAgICAgIGxldCB0ID0gaW50ZXJzZWN0c1swXS5vYmplY3QucG9zaXRpb25cclxuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRNZXNoLnBvc2l0aW9uLnNldCh0LngsdC55LHQueilcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRNZXNoLnJvdGF0aW9uLnNldCgwLDAsMClcclxuICAgICAgICAgICAgICAgIHRoaXMuaG9sZE1hcFt0aGlzLnNlbGVjdGVkTWVzaC5pZF0ucG9zaXRpb24ueiAtPSAxXHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkTWVzaC52aXNpYmxlID0gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgdGhpcy5tb3VzZS5waWNrQnRuLmlubmVySFRNTCA9IFwi5o2h6LW3XCJcclxuICAgICAgICAgICAgICAgIC8v5Zyo5pyq5ou85oiQ5Zu+54mH5YiX6KGo5Lit5Y+W5Ye65b2T5YmN6aG5XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZyZWVQaWVjZUxpc3Quc3BsaWNlKHRoaXMuZnJlZVBpZWNlTGlzdC5pbmRleE9mKHRoaXMuc2VsZWN0ZWRNZXNoLmlkKSwxKVxyXG4gICAgICAgICAgICAgICAgLy/muIXmpZrlvZPliY3pgInlj5bnmoTlm77lg49cclxuICAgICAgICAgICAgICAgIHRoaXMuY2xlYXJDYW52YXMoKVxyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZE1lc2ggPSBudWxsXHJcbiAgICAgICAgICAgICAgICBpZih0aGlzLmZyZWVQaWVjZUxpc3QubGVuZ3RoID09IDApe1xyXG4gICAgICAgICAgICAgICAgICAgIHN3YWwoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTpcIuaBreWWnO+8gVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiBcIuaIkOWKn+aLvOWujOS6huS4gOW8oOWbvu+8jOWPr+aYr+aIkeS5n+S4jeS8mue7meS9oOa1gemHj1wiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogXCLlpb3nmoRcIlxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYodGhpcy5zZWxlY3RlZE1lc2ggJiYgIWNsaWNrRmxhZyl7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1vdXNlLnBpY2tCdG4uaW5uZXJIVE1MID0gXCLmjaHotbdcIlxyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZE1lc2gudmlzaWJsZSA9IHRydWVcclxuICAgICAgICAgICAgICAgIHRoaXMuY2xlYXJDYW52YXMoKVxyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZE1lc2ggPSBudWxsXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuY29udHJvbHMudXBkYXRlKClcclxuICAgICAgICB0aGlzLnJlbmRlcmVyLnJlbmRlcih0aGlzLnNjZW5lLHRoaXMuY2FtZXJhKVxyXG5cclxuICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy5yZW5kZXIpXHJcbiAgICB9XHJcbiAgICBvblJlc2l6ZShlKSB7XHJcbiAgICAgICAgdGhpcy5jYW1lcmEuYXNwZWN0ID0gd2luZG93LmlubmVyV2lkdGggLyB3aW5kb3cuaW5uZXJIZWlnaHQ7XHJcblx0XHR0aGlzLmNhbWVyYS51cGRhdGVQcm9qZWN0aW9uTWF0cml4KCk7XHJcblx0XHR0aGlzLnJlbmRlcmVyLnNldFNpemUoIHdpbmRvdy5pbm5lcldpZHRoLCB3aW5kb3cuaW5uZXJIZWlnaHQgKTtcclxuICAgIH1cclxuICAgIGNsZWFyQ2FudmFzKCl7XHJcbiAgICAgICAgbGV0IGNhbnZhcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcGluIGNhbnZhc1wiKVxyXG4gICAgICAgIGxldCBwaW4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBpblwiKVxyXG4gICAgICAgIHdoaWxlKGNhbnZhcyE9bnVsbCl7XHJcbiAgICAgICAgICAgIHBpbi5yZW1vdmVDaGlsZChjYW52YXMpXHJcbiAgICAgICAgICAgIGNhbnZhcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcGluIGNhbnZhc1wiKVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL3NyYy9qYXZhc2NyaXB0cy9nYW1lLmpzXG4gKiovIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgTW91c2UgZXh0ZW5kcyBUSFJFRS5WZWN0b3Iye1xyXG4gICAgY29uc3RydWN0b3IocHJvcHMpe1xyXG4gICAgICAgIHN1cGVyKHByb3BzKVxyXG4gICAgICAgIHRoaXMueCA9IHVuZGVmaW5lZFxyXG4gICAgICAgIHRoaXMueSA9IHVuZGVmaW5lZFxyXG4gICAgICAgIC8vIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCBcImNsaWNrXCIsIHRoaXMub25Nb3VzZUNsaWNrLmJpbmQodGhpcyksIGZhbHNlIClcclxuICAgICAgICB0aGlzLnBpY2tCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBpY2stYnRuXCIpXHJcbiAgICAgICAgdGhpcy5waWNrSGFuZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicGljay1oYW5kXCIpXHJcbiAgICAgICAgdGhpcy5waWNrQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLHRoaXMuYnRuT25DbGljay5iaW5kKHRoaXMpLGZhbHNlKVxyXG4gICAgICAgIC8vIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIix0aGlzLm9uTW91c2VDbGljay5iaW5kKHRoaXMpLGZhbHNlKVxyXG4gICAgfVxyXG4gICAgb25Nb3VzZUNsaWNrKCBldmVudCApIHtcclxuICAgIFx0Ly8gY2FsY3VsYXRlIG1vdXNlIHBvc2l0aW9uIGluIG5vcm1hbGl6ZWQgZGV2aWNlIGNvb3JkaW5hdGVzXHJcbiAgICBcdC8vICgtMSB0byArMSkgZm9yIGJvdGggY29tcG9uZW50c1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKGV2ZW50LmNsaWVudFgsZXZlbnQuY2xpZW50WSlcclxuICAgICAgICB0aGlzLnggPSAoIGV2ZW50LmNsaWVudFggLyB3aW5kb3cuaW5uZXJXaWR0aCApICogMiAtIDFcclxuICAgICAgICB0aGlzLnkgPSAtICggZXZlbnQuY2xpZW50WSAvIHdpbmRvdy5pbm5lckhlaWdodCApICogMiArIDFcclxuICAgICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLngsdGhpcy55KVxyXG4gICAgfVxyXG4gICAgYnRuT25DbGljayggZXZlbnQgKSB7XHJcbiAgICAgICAgdGhpcy54ID0gKCAwLjQ2ICkgKiAyIC0gMVxyXG4gICAgICAgIHRoaXMueSA9IC0gKCAwLjM5NSApICogMiArIDFcclxuICAgICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLngsdGhpcy55KVxyXG4gICAgfVxyXG59XHJcblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL2phdmFzY3JpcHRzL21vdXNlLmpzXG4gKiovIiwibW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcHVibGljX3BhdGhfXyArIFwiaW1hZ2VzL3B1enpsZXMvY2FydG9vbiAoMykuanBnXCI7XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL3B1YmxpYy9pbWFnZXMvcHV6emxlcy9jYXJ0b29uICgzKS5qcGdcbiAqKiBtb2R1bGUgaWQgPSAzXG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCJtb2R1bGUuZXhwb3J0cyA9IHN3YWw7XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiBleHRlcm5hbCBcInN3YWxcIlxuICoqIG1vZHVsZSBpZCA9IDRcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsIm1vZHVsZS5leHBvcnRzID0gdHJ1ZTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIGV4dGVybmFsIFwidHJ1ZVwiXG4gKiogbW9kdWxlIGlkID0gNVxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIl0sInNvdXJjZVJvb3QiOiIifQ==