!function(e){function t(n){if(i[n])return i[n].exports;var s=i[n]={exports:{},id:n,loaded:!1};return e[n].call(s.exports,s,s.exports,t),s.loaded=!0,s.exports}var i={};return t.m=e,t.c=i,t.p="/VRPuzzle/public/",t(0)}([function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}i(5);var s=i(1),r=n(s),o=new r["default"],a=function(){var e=window.innerWidth,t=window.innerHeight,i=document.querySelector("#pin>img");i.style.width=.12*e+"px",i.style.height=.12*e+"px",i.style.left=.44*e+"px",i.style.top=.4*t-.06*e+"px";var n=document.querySelector("#pin>button");n.style.width=.32*e,n.style.height=.1*t,n.style.left=.34*e,n.style.bottom=.1*t},h=function(){a(),o.render()};h()},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=i(2),a=n(o),h=i(4),l=n(h),c=function(){function e(){s(this,e),this.scene=new THREE.Scene,this.camera=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,1e4),this.camera.position.set(0,10,0),this.controls=new THREE.DeviceOrientationControls(this.camera),this.renderer=new THREE.WebGLRenderer({antialias:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.domElement.style.position="absolute",this.renderer.domElement.style.top=0,document.body.appendChild(this.renderer.domElement),this.raycaster=new THREE.Raycaster,this.mouse=new a["default"],this.onTextureLoaded=this.onTextureLoaded.bind(this),this.onResize=this.onResize.bind(this),this.render=this.render.bind(this),this.placePieces=this.placePieces.bind(this),this.meshList=[],this.logFlag=!0,this.boxSize=50,this.onTextureLoaded(),window.addEventListener("resize",this.onResize,!0),this.lastRender=0,this.display=null}return r(e,[{key:"onTextureLoaded",value:function(){var e=new THREE.BoxGeometry(this.boxSize,this.boxSize,this.boxSize),t=new THREE.MeshBasicMaterial({alphaMap:0});this.skybox=new THREE.Mesh(e,t),this.skybox.position.y=this.boxSize/2,this.scene.add(this.skybox),this.placePieces(),this.placeSphere()}},{key:"placeSphere",value:function(){var e=new THREE.SphereGeometry(100,100,100);e.scale(-1,1,1);var t=new THREE.TextureLoader,i=this;t.load("public/images/sphere (3).jpg",function(t){var n=new THREE.MeshBasicMaterial({map:t}),s=new THREE.Mesh(e,n);s.position.set(0,0,10),i.scene.add(s)})}},{key:"placePieces",value:function(){this.columnNumber=4,this.pieceNumber=this.columnNumber*this.columnNumber,this.scaledWidth=16,this.scaledHeight=9,this.freePieceNumber=1*this.pieceNumber/2,this.freePieceList=[],this.planeWidth=this.scaledWidth/this.columnNumber,this.planeHeight=this.scaledHeight/this.columnNumber,this.selectedMesh=null,this.holdMap={},this.meshCanvasMap={};var e=new Image;e.src=i(3);var t=document.createElement("canvas"),n=window.innerWidth,s=window.innerHeight,r={width:.4*n+"px",height:.16*s+"px",left:.3*n+"px",top:.32*s+"px"};t.style.width=r.width,t.style.height=r.height,t.style.left=r.left,t.style.top=r.top;var o=t.getContext("2d"),a=this;e.onload=function(){a.pieceWidth=e.width/a.columnNumber,a.pieceHeight=e.height/a.columnNumber;for(var i,n,s,h=0,l=0;h<a.columnNumber;h++)for(var c=0;c<a.columnNumber;c++,l++){t=document.createElement("canvas"),t.style.width=r.width,t.style.height=r.height,t.style.left=r.left,t.style.top=r.top,o=t.getContext("2d"),i=new THREE.Texture(t),o.drawImage(e,h*a.pieceWidth,c*a.pieceHeight,a.pieceWidth,a.pieceHeight,0,0,t.width,t.height),i&&(i.needsUpdate=!0),n=new THREE.MeshBasicMaterial({map:i,side:THREE.DoubleSide}),n.transparent=!1,s=new THREE.Mesh(new THREE.PlaneGeometry(a.planeWidth,a.planeHeight),n);var d=Math.random();if(d<a.freePieceNumber/(a.columnNumber*a.columnNumber-l)&&a.freePieceNumber>0){var u=-a.boxSize/2+a.planeWidth/2+Math.random()*(a.boxSize-a.planeWidth),p=-a.boxSize/2+a.planeHeight/2+Math.random()*(a.boxSize-a.planeHeight);s.rotation.x=Math.PI/2,s.position.set(Math.round(u),.5,Math.round(p));var f=s.clone();a.holdMap[s.id]=f,f.rotation.x=0,f.material=new THREE.MeshBasicMaterial({color:8421504,side:THREE.DoubleSide}),f.position.set(h*a.planeWidth-a.scaledWidth/2+a.planeWidth/2,5+a.scaledHeight-a.planeHeight/2-c*a.planeHeight,-9.99),a.scene.add(f),a.freePieceNumber--,a.freePieceList.push(s.id),a.meshCanvasMap[s.id]=t}else s.position.set(h*a.planeWidth-a.scaledWidth/2+a.planeWidth/2,5+a.scaledHeight-a.planeHeight/2-c*a.planeHeight,-9.99);a.meshList.push(s),a.scene.add(s)}}}},{key:"render",value:function(e){this.lastRender=e,this.raycaster.setFromCamera(this.mouse,this.camera);var t=this.raycaster.intersectObjects(this.scene.children);if(this.mouse.x=this.mouse.y=void 0,t.length>0){var i=!1,n=!0,s=!1,r=void 0;try{for(var o,a=this.meshList[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var h=o.value;this.freePieceList.indexOf(h.id)>-1&&h.id==t[0].object.id&&(null!==this.selectedMesh&&(this.clearCanvas(),this.selectedMesh.visible=!0),this.selectedMesh=h,this.mouse.pickBtn.innerHTML="贴上",i=!0,h.visible=!1,document.getElementById("pin").appendChild(this.meshCanvasMap[h.id]))}}catch(c){s=!0,r=c}finally{try{!n&&a["return"]&&a["return"]()}finally{if(s)throw r}}if(this.selectedMesh&&this.holdMap[this.selectedMesh.id].id==t[0].object.id){var d=t[0].object.position;this.selectedMesh.position.set(d.x,d.y,d.z),this.selectedMesh.rotation.set(0,0,0),this.holdMap[this.selectedMesh.id].position.z-=1,this.selectedMesh.visible=!0,this.mouse.pickBtn.innerHTML="捡起",this.freePieceList.splice(this.freePieceList.indexOf(this.selectedMesh.id),1),this.clearCanvas(),this.selectedMesh=null,0==this.freePieceList.length&&(0,l["default"])({title:"恭喜！",text:"成功拼完了一张图，可是我也不会给你流量",confirmButtonText:"好的"})}this.selectedMesh&&!i&&(this.mouse.pickBtn.innerHTML="捡起",this.selectedMesh.visible=!0,this.clearCanvas(),this.selectedMesh=null)}this.controls.update(),this.renderer.render(this.scene,this.camera),requestAnimationFrame(this.render)}},{key:"onResize",value:function(e){this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(window.innerWidth,window.innerHeight)}},{key:"clearCanvas",value:function(){for(var e=document.querySelector("#pin canvas"),t=document.getElementById("pin");null!=e;)t.removeChild(e),e=document.querySelector("#pin canvas")}}]),e}();t["default"]=c},function(e,t){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=function(e){function t(e){i(this,t);var s=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return s.x=void 0,s.y=void 0,s.pickBtn=document.getElementById("pick-btn"),s.pickHand=document.getElementById("pick-hand"),s.pickBtn.addEventListener("click",s.btnOnClick.bind(s),!1),s}return s(t,e),r(t,[{key:"onMouseClick",value:function(e){this.x=e.clientX/window.innerWidth*2-1,this.y=2*-(e.clientY/window.innerHeight)+1}},{key:"btnOnClick",value:function(e){this.x=0,this.y=-.8+1}}]),t}(THREE.Vector2);t["default"]=o},function(e,t,i){e.exports=i.p+"images/puzzles/cartoon (2).jpg"},function(e,t){e.exports=swal},function(e,t){e.exports=!0}]);