!function(e){function t(n){if(i[n])return i[n].exports;var s=i[n]={exports:{},id:n,loaded:!1};return e[n].call(s.exports,s,s.exports,t),s.loaded=!0,s.exports}var i={};return t.m=e,t.c=i,t.p="/VRPuzzle/public/",t(0)}([function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}i(5);var s=i(1),r=n(s),o=new r["default"],a=function(){o.render()};a()},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=i(2),a=n(o),h=i(4),c=n(h),l=function(){function e(){s(this,e),this.scene=new THREE.Scene,this.camera=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,1e4),this.camera.position.set(0,10,0),this.controls=new THREE.DeviceOrientationControls(this.camera),this.renderer=new THREE.WebGLRenderer({antialias:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.domElement.style.position="absolute",this.renderer.domElement.style.top=0,document.body.appendChild(this.renderer.domElement),this.raycaster=new THREE.Raycaster,this.mouse=new a["default"],this.onTextureLoaded=this.onTextureLoaded.bind(this),this.onResize=this.onResize.bind(this),this.render=this.render.bind(this),this.placePieces=this.placePieces.bind(this),this.meshList=[],this.logFlag=!0,this.boxSize=50,this.onTextureLoaded(),window.addEventListener("resize",this.onResize,!0),this.lastRender=0,this.display=null}return r(e,[{key:"onTextureLoaded",value:function(){var e=new THREE.BoxGeometry(this.boxSize,this.boxSize,this.boxSize),t=new THREE.MeshBasicMaterial({alphaMap:0});this.skybox=new THREE.Mesh(e,t),this.skybox.position.y=this.boxSize/2,this.scene.add(this.skybox),this.placePieces(),this.placeSphere()}},{key:"placeSphere",value:function(){var e=new THREE.SphereGeometry(100,100,100);e.scale(-1,1,1);var t=new THREE.TextureLoader,i=this;t.load("public/images/sphere (2).jpg",function(t){var n=new THREE.MeshBasicMaterial({map:t}),s=new THREE.Mesh(e,n);s.position.set(0,0,10),i.scene.add(s)})}},{key:"placePieces",value:function(){this.columnNumber=4,this.pieceNumber=this.columnNumber*this.columnNumber,this.scaledWidth=16,this.scaledHeight=9,this.freePieceNumber=1*this.pieceNumber/2,this.freePieceList=[],this.planeWidth=this.scaledWidth/this.columnNumber,this.planeHeight=this.scaledHeight/this.columnNumber,this.selectedMesh=null,this.holdMap={},this.meshCanvasMap={};var e=new Image;e.src=i(3);var t=document.createElement("canvas"),n=t.getContext("2d"),s=this;e.onload=function(){s.pieceWidth=e.width/s.columnNumber,s.pieceHeight=e.height/s.columnNumber;for(var i,r,o,a=0,h=0;a<s.columnNumber;a++)for(var c=0;c<s.columnNumber;c++,h++){t=document.createElement("canvas"),n=t.getContext("2d"),i=new THREE.Texture(t),n.drawImage(e,a*s.pieceWidth,c*s.pieceHeight,s.pieceWidth,s.pieceHeight,0,0,t.width,t.height),i&&(i.needsUpdate=!0),r=new THREE.MeshBasicMaterial({map:i,side:THREE.DoubleSide}),r.transparent=!1,o=new THREE.Mesh(new THREE.PlaneGeometry(s.planeWidth,s.planeHeight),r);var l=Math.random();if(l<s.freePieceNumber/(s.columnNumber*s.columnNumber-h)&&s.freePieceNumber>0){var d=-s.boxSize/2+s.planeWidth/2+Math.random()*(s.boxSize-s.planeWidth),u=-s.boxSize/2+s.planeHeight/2+Math.random()*(s.boxSize-s.planeHeight);o.rotation.x=Math.PI/2,o.position.set(Math.round(d),.5,Math.round(u));var p=o.clone();s.holdMap[o.id]=p,p.rotation.x=0,p.material=new THREE.MeshBasicMaterial({color:8421504,side:THREE.DoubleSide}),p.position.set(a*s.planeWidth-s.scaledWidth/2+s.planeWidth/2,5+s.scaledHeight-s.planeHeight/2-c*s.planeHeight,-9.99),s.scene.add(p),s.freePieceNumber--,s.freePieceList.push(o.id),s.meshCanvasMap[o.id]=t}else o.position.set(a*s.planeWidth-s.scaledWidth/2+s.planeWidth/2,5+s.scaledHeight-s.planeHeight/2-c*s.planeHeight,-9.99);s.meshList.push(o),s.scene.add(o)}}}},{key:"render",value:function(e){this.lastRender=e,this.raycaster.setFromCamera(this.mouse,this.camera);var t=this.raycaster.intersectObjects(this.scene.children);if(this.mouse.x=this.mouse.y=void 0,t.length>0){var i=!1,n=!0,s=!1,r=void 0;try{for(var o,a=this.meshList[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var h=o.value;this.freePieceList.indexOf(h.id)>-1&&h.id==t[0].object.id&&(null!==this.selectedMesh&&(this.clearCanvas(),this.selectedMesh.visible=!0),this.selectedMesh=h,this.mouse.pickBtn.innerHTML="贴上",i=!0,h.visible=!1,document.getElementById("pin").appendChild(this.meshCanvasMap[h.id]))}}catch(l){s=!0,r=l}finally{try{!n&&a["return"]&&a["return"]()}finally{if(s)throw r}}if(this.selectedMesh&&this.holdMap[this.selectedMesh.id].id==t[0].object.id){var d=t[0].object.position;this.selectedMesh.position.set(d.x,d.y,d.z),this.selectedMesh.rotation.set(0,0,0),this.holdMap[this.selectedMesh.id].position.z-=1,this.selectedMesh.visible=!0,this.mouse.pickBtn.innerHTML="捡起",this.freePieceList.splice(this.freePieceList.indexOf(this.selectedMesh.id),1),this.clearCanvas(),this.selectedMesh=null,0==this.freePieceList.length&&(0,c["default"])({title:"恭喜！",text:"成功拼完了一张图，可是我也不会给你流量",confirmButtonText:"好的"})}this.selectedMesh&&!i&&(this.mouse.pickBtn.innerHTML="捡起",this.selectedMesh.visible=!0,this.clearCanvas(),this.selectedMesh=null)}this.controls.update(),this.renderer.render(this.scene,this.camera),requestAnimationFrame(this.render)}},{key:"onResize",value:function(e){this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(window.innerWidth,window.innerHeight)}},{key:"clearCanvas",value:function(){for(var e=document.querySelector("#pin canvas"),t=document.getElementById("pin");null!=e;)t.removeChild(e),e=document.querySelector("#pin canvas")}}]),e}();t["default"]=l},function(e,t){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=function(e){function t(e){i(this,t);var s=n(this,Object.getPrototypeOf(t).call(this,e));return s.x=void 0,s.y=void 0,s.pickBtn=document.getElementById("pick-btn"),s.pickHand=document.getElementById("pick-hand"),s.pickBtn.addEventListener("click",s.btnOnClick.bind(s),!1),s}return s(t,e),r(t,[{key:"onMouseClick",value:function(e){this.x=e.clientX/window.innerWidth*2-1,this.y=2*-(e.clientY/window.innerHeight)+1}},{key:"btnOnClick",value:function(e){this.x=.92-1,this.y=-.79+1}}]),t}(THREE.Vector2);t["default"]=o},function(e,t,i){e.exports=i.p+"images/puzzles/cartoon (3).jpg"},function(e,t){e.exports=swal},function(e,t){e.exports=!0}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vVlJQdXp6bGUuYnVuZGxlLmpzIiwid2VicGFjazovLy93ZWJwYWNrL2Jvb3RzdHJhcCAxMGI1ZTdlYWYwNjQyNWNjMmMwYSIsIndlYnBhY2s6Ly8vLi9zcmMvamF2YXNjcmlwdHMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2phdmFzY3JpcHRzL2dhbWUuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2phdmFzY3JpcHRzL21vdXNlLmpzIiwid2VicGFjazovLy8uL3B1YmxpYy9pbWFnZXMvcHV6emxlcy9jYXJ0b29uICgzKS5qcGciLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIFwic3dhbFwiIiwid2VicGFjazovLy9leHRlcm5hbCBcInRydWVcIiJdLCJuYW1lcyI6WyJtb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiaW5zdGFsbGVkTW9kdWxlcyIsImV4cG9ydHMiLCJtb2R1bGUiLCJpZCIsImxvYWRlZCIsImNhbGwiLCJtIiwiYyIsInAiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0Iiwib2JqIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJfZ2FtZSIsIl9nYW1lMiIsImdhbWUiLCJsb29wIiwicmVuZGVyIiwiX2NsYXNzQ2FsbENoZWNrIiwiaW5zdGFuY2UiLCJDb25zdHJ1Y3RvciIsIlR5cGVFcnJvciIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwidmFsdWUiLCJfY3JlYXRlQ2xhc3MiLCJkZWZpbmVQcm9wZXJ0aWVzIiwidGFyZ2V0IiwicHJvcHMiLCJpIiwibGVuZ3RoIiwiZGVzY3JpcHRvciIsImVudW1lcmFibGUiLCJjb25maWd1cmFibGUiLCJ3cml0YWJsZSIsImtleSIsInByb3RvUHJvcHMiLCJzdGF0aWNQcm9wcyIsInByb3RvdHlwZSIsIl9tb3VzZSIsIl9tb3VzZTIiLCJfc3dlZXRhbGVydCIsIl9zd2VldGFsZXJ0MiIsIkdhbWUiLCJ0aGlzIiwic2NlbmUiLCJUSFJFRSIsIlNjZW5lIiwiY2FtZXJhIiwiUGVyc3BlY3RpdmVDYW1lcmEiLCJ3aW5kb3ciLCJpbm5lcldpZHRoIiwiaW5uZXJIZWlnaHQiLCJwb3NpdGlvbiIsInNldCIsImNvbnRyb2xzIiwiRGV2aWNlT3JpZW50YXRpb25Db250cm9scyIsInJlbmRlcmVyIiwiV2ViR0xSZW5kZXJlciIsImFudGlhbGlhcyIsInNldFBpeGVsUmF0aW8iLCJkZXZpY2VQaXhlbFJhdGlvIiwic2V0U2l6ZSIsImRvbUVsZW1lbnQiLCJzdHlsZSIsInRvcCIsImRvY3VtZW50IiwiYm9keSIsImFwcGVuZENoaWxkIiwicmF5Y2FzdGVyIiwiUmF5Y2FzdGVyIiwibW91c2UiLCJvblRleHR1cmVMb2FkZWQiLCJiaW5kIiwib25SZXNpemUiLCJwbGFjZVBpZWNlcyIsIm1lc2hMaXN0IiwibG9nRmxhZyIsImJveFNpemUiLCJhZGRFdmVudExpc3RlbmVyIiwibGFzdFJlbmRlciIsImRpc3BsYXkiLCJnZW9tZXRyeSIsIkJveEdlb21ldHJ5IiwibWF0ZXJpYWwiLCJNZXNoQmFzaWNNYXRlcmlhbCIsImFscGhhTWFwIiwic2t5Ym94IiwiTWVzaCIsInkiLCJhZGQiLCJwbGFjZVNwaGVyZSIsIlNwaGVyZUdlb21ldHJ5Iiwic2NhbGUiLCJsb2FkZXIiLCJUZXh0dXJlTG9hZGVyIiwic2VsZiIsImxvYWQiLCJ0ZXh0dXJlIiwibWFwIiwibWVzaCIsImNvbHVtbk51bWJlciIsInBpZWNlTnVtYmVyIiwic2NhbGVkV2lkdGgiLCJzY2FsZWRIZWlnaHQiLCJmcmVlUGllY2VOdW1iZXIiLCJmcmVlUGllY2VMaXN0IiwicGxhbmVXaWR0aCIsInBsYW5lSGVpZ2h0Iiwic2VsZWN0ZWRNZXNoIiwiaG9sZE1hcCIsIm1lc2hDYW52YXNNYXAiLCJpbWFnZU9iaiIsIkltYWdlIiwic3JjIiwiY2FudmFzIiwiY3JlYXRlRWxlbWVudCIsImNvbnRleHQiLCJnZXRDb250ZXh0Iiwib25sb2FkIiwicGllY2VXaWR0aCIsIndpZHRoIiwicGllY2VIZWlnaHQiLCJoZWlnaHQiLCJpbmRleCIsImoiLCJUZXh0dXJlIiwiZHJhd0ltYWdlIiwibmVlZHNVcGRhdGUiLCJzaWRlIiwiRG91YmxlU2lkZSIsInRyYW5zcGFyZW50IiwiUGxhbmVHZW9tZXRyeSIsInJhbmRvbSIsIk1hdGgiLCJ4IiwieiIsInJvdGF0aW9uIiwiUEkiLCJyb3VuZCIsImJsYW5rTWVzaCIsImNsb25lIiwiY29sb3IiLCJwdXNoIiwidGltZXN0YW1wIiwic2V0RnJvbUNhbWVyYSIsImludGVyc2VjdHMiLCJpbnRlcnNlY3RPYmplY3RzIiwiY2hpbGRyZW4iLCJ1bmRlZmluZWQiLCJjbGlja0ZsYWciLCJfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uIiwiX2RpZEl0ZXJhdG9yRXJyb3IiLCJfaXRlcmF0b3JFcnJvciIsIl9zdGVwIiwiX2l0ZXJhdG9yIiwiU3ltYm9sIiwiaXRlcmF0b3IiLCJuZXh0IiwiZG9uZSIsImluZGV4T2YiLCJvYmplY3QiLCJjbGVhckNhbnZhcyIsInZpc2libGUiLCJwaWNrQnRuIiwiaW5uZXJIVE1MIiwiZ2V0RWxlbWVudEJ5SWQiLCJlcnIiLCJ0Iiwic3BsaWNlIiwidGl0bGUiLCJ0ZXh0IiwiY29uZmlybUJ1dHRvblRleHQiLCJ1cGRhdGUiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJlIiwiYXNwZWN0IiwidXBkYXRlUHJvamVjdGlvbk1hdHJpeCIsInF1ZXJ5U2VsZWN0b3IiLCJwaW4iLCJyZW1vdmVDaGlsZCIsIl9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuIiwiUmVmZXJlbmNlRXJyb3IiLCJfaW5oZXJpdHMiLCJzdWJDbGFzcyIsInN1cGVyQ2xhc3MiLCJjcmVhdGUiLCJjb25zdHJ1Y3RvciIsInNldFByb3RvdHlwZU9mIiwiX19wcm90b19fIiwiTW91c2UiLCJfVEhSRUUkVmVjdG9yIiwiX3RoaXMiLCJnZXRQcm90b3R5cGVPZiIsInBpY2tIYW5kIiwiYnRuT25DbGljayIsImV2ZW50IiwiY2xpZW50WCIsImNsaWVudFkiLCJWZWN0b3IyIiwic3dhbCJdLCJtYXBwaW5ncyI6IkNBQVMsU0FBVUEsR0NJbkIsUUFBQUMsR0FBQUMsR0FHQSxHQUFBQyxFQUFBRCxHQUNBLE1BQUFDLEdBQUFELEdBQUFFLE9BR0EsSUFBQUMsR0FBQUYsRUFBQUQsSUFDQUUsV0FDQUUsR0FBQUosRUFDQUssVUFVQSxPQU5BUCxHQUFBRSxHQUFBTSxLQUFBSCxFQUFBRCxRQUFBQyxJQUFBRCxRQUFBSCxHQUdBSSxFQUFBRSxVQUdBRixFQUFBRCxRQXZCQSxHQUFBRCxLQXFDQSxPQVRBRixHQUFBUSxFQUFBVCxFQUdBQyxFQUFBUyxFQUFBUCxFQUdBRixFQUFBVSxFQUFBLG9CQUdBVixFQUFBLEtETU0sU0FBU0ksRUFBUUQsRUFBU0gsR0FFL0IsWUFRQSxTQUFTVyxHQUF1QkMsR0FBTyxNQUFPQSxJQUFPQSxFQUFJQyxXQUFhRCxHQUFRRSxVQUFTRixHRXREeEZaLEVBQUEsRUFDQSxJQUFBZSxHQUFBZixFQUFBLEdGbURLZ0IsRUFBU0wsRUFBdUJJLEdFbERqQ0UsRUFBTyxHQUFBRCxjQUVMRSxFQUFPLFdBQ1RELEVBQUtFLFNBR1RELE1GMERNLFNBQVNkLEVBQVFELEVBQVNILEdBRS9CLFlBZ0JBLFNBQVNXLEdBQXVCQyxHQUFPLE1BQU9BLElBQU9BLEVBQUlDLFdBQWFELEdBQVFFLFVBQVNGLEdBRXZGLFFBQVNRLEdBQWdCQyxFQUFVQyxHQUFlLEtBQU1ELFlBQW9CQyxJQUFnQixLQUFNLElBQUlDLFdBQVUscUNBaEJoSEMsT0FBT0MsZUFBZXRCLEVBQVMsY0FDM0J1QixVQUdKLElBQUlDLEdBQWUsV0FBYyxRQUFTQyxHQUFpQkMsRUFBUUMsR0FBUyxJQUFLLEdBQUlDLEdBQUksRUFBR0EsRUFBSUQsRUFBTUUsT0FBUUQsSUFBSyxDQUFFLEdBQUlFLEdBQWFILEVBQU1DLEVBQUlFLEdBQVdDLFdBQWFELEVBQVdDLGVBQXFCRCxFQUFXRSxnQkFBeUIsU0FBV0YsS0FBWUEsRUFBV0csYUFBaUJaLE9BQU9DLGVBQWVJLEVBQVFJLEVBQVdJLElBQUtKLElBQWlCLE1BQU8sVUFBVVgsRUFBYWdCLEVBQVlDLEdBQWlKLE1BQTlIRCxJQUFZVixFQUFpQk4sRUFBWWtCLFVBQVdGLEdBQWlCQyxHQUFhWCxFQUFpQk4sRUFBYWlCLEdBQXFCakIsTUd6RWppQm1CLEVBQUF6QyxFQUFBLEdINkVLMEMsRUFBVS9CLEVBQXVCOEIsR0c1RXRDRSxFQUFBM0MsRUFBQSxHSGdGSzRDLEVBQWVqQyxFQUF1QmdDLEdHOUV0QkUsRUhvRlQsV0duRlIsUUFBQUEsS0FBY3pCLEVBQUEwQixLQUFBRCxHQUVWQyxLQUFLQyxNQUFRLEdBQUlDLE9BQU1DLE1BR3ZCSCxLQUFLSSxPQUFTLEdBQUlGLE9BQU1HLGtCQUFrQixHQUFJQyxPQUFPQyxXQUFhRCxPQUFPRSxZQUFhLEdBQUssS0FFM0ZSLEtBQUtJLE9BQU9LLFNBQVNDLElBQUksRUFBRSxHQUFHLEdBQzlCVixLQUFLVyxTQUFXLEdBQUlULE9BQU1VLDBCQUEyQlosS0FBS0ksUUFFMURKLEtBQUthLFNBQVcsR0FBSVgsT0FBTVksZUFDdEJDLGVBRVZmLEtBQUthLFNBQVNHLGNBQWVWLE9BQU9XLGtCQUNwQ2pCLEtBQUthLFNBQVNLLFFBQVFaLE9BQU9DLFdBQVlELE9BQU9FLGFBQ2hEUixLQUFLYSxTQUFTTSxXQUFXQyxNQUFNWCxTQUFXLFdBQzFDVCxLQUFLYSxTQUFTTSxXQUFXQyxNQUFNQyxJQUFNLEVBQ3JDQyxTQUFTQyxLQUFLQyxZQUFZeEIsS0FBS2EsU0FBU00sWUFHbENuQixLQUFLeUIsVUFBWSxHQUFJdkIsT0FBTXdCLFVBQzNCMUIsS0FBSzJCLE1BQVEsR0FBQS9CLGNBRWJJLEtBQUs0QixnQkFBa0I1QixLQUFLNEIsZ0JBQWdCQyxLQUFLN0IsTUFDakRBLEtBQUs4QixTQUFXOUIsS0FBSzhCLFNBQVNELEtBQUs3QixNQUNuQ0EsS0FBSzNCLE9BQVMyQixLQUFLM0IsT0FBT3dELEtBQUs3QixNQUMvQkEsS0FBSytCLFlBQWMvQixLQUFLK0IsWUFBWUYsS0FBSzdCLE1BRXpDQSxLQUFLZ0MsWUFDTGhDLEtBQUtpQyxXQUVMakMsS0FBS2tDLFFBQVUsR0FJZmxDLEtBQUs0QixrQkFDTHRCLE9BQU82QixpQkFBaUIsU0FBVW5DLEtBQUs4QixhQUV2QzlCLEtBQUtvQyxXQUFhLEVBQ2xCcEMsS0FBS3FDLFFBQVUsS0g2U2xCLE1BcE5BeEQsR0FBYWtCLElBQ1RSLElBQUssa0JBQ0xYLE1BQU8sV0dwRlIsR0FBSTBELEdBQVcsR0FBSXBDLE9BQU1xQyxZQUFZdkMsS0FBS2tDLFFBQVNsQyxLQUFLa0MsUUFBU2xDLEtBQUtrQyxTQUVsRU0sRUFBVyxHQUFJdEMsT0FBTXVDLG1CQUFvQkMsU0FBVSxHQUd2RDFDLE1BQUsyQyxPQUFTLEdBQUl6QyxPQUFNMEMsS0FBS04sRUFBVUUsR0FDdkN4QyxLQUFLMkMsT0FBT2xDLFNBQVNvQyxFQUFJN0MsS0FBS2tDLFFBQVUsRUFDeENsQyxLQUFLQyxNQUFNNkMsSUFBSTlDLEtBQUsyQyxRQUNwQjNDLEtBQUsrQixjQUNML0IsS0FBSytDLGlCSDRGSnhELElBQUssY0FDTFgsTUFBTyxXRzFGUixHQUFJMEQsR0FBVyxHQUFJcEMsT0FBTThDLGVBQWdCLElBQUssSUFBSyxJQUNuRFYsR0FBU1csU0FBUyxFQUFFLEVBR3BCLElBQUlDLEdBQVMsR0FBSWhELE9BQU1pRCxjQUNuQkMsRUFBT3BELElBQ1hrRCxHQUFPRyxLQUFLLCtCQUErQixTQUFTQyxHQUNoRCxHQUFJZCxHQUFXLEdBQUl0QyxPQUFNdUMsbUJBQzlCYyxJQUFLRCxJQUdGRSxFQUFPLEdBQUl0RCxPQUFNMEMsS0FBTU4sRUFBVUUsRUFDL0JnQixHQUFLL0MsU0FBU0MsSUFBSSxFQUFFLEVBQUUsSUFDNUIwQyxFQUFLbkQsTUFBTTZDLElBQUtVLFFIK0ZiakUsSUFBSyxjQUNMWCxNQUFPLFdHM0ZSb0IsS0FBS3lELGFBQWUsRUFDcEJ6RCxLQUFLMEQsWUFBYzFELEtBQUt5RCxhQUFlekQsS0FBS3lELGFBQzVDekQsS0FBSzJELFlBQWMsR0FDbkIzRCxLQUFLNEQsYUFBZSxFQUNwQjVELEtBQUs2RCxnQkFBcUMsRUFBbkI3RCxLQUFLMEQsWUFBa0IsRUFDOUMxRCxLQUFLOEQsaUJBQ0w5RCxLQUFLK0QsV0FBYS9ELEtBQUsyRCxZQUFjM0QsS0FBS3lELGFBQzFDekQsS0FBS2dFLFlBQWNoRSxLQUFLNEQsYUFBZTVELEtBQUt5RCxhQUM1Q3pELEtBQUtpRSxhQUFlLEtBQ3BCakUsS0FBS2tFLFdBQ0xsRSxLQUFLbUUsZ0JBQ0wsSUFBSUMsR0FBVyxHQUFJQyxNQUNuQkQsR0FBU0UsSUFBTXBILEVBQVEsRUFDdkIsSUFBSXFILEdBQVNqRCxTQUFTa0QsY0FBYyxVQUNoQ0MsRUFBVUYsRUFBT0csV0FBVyxNQUM1QnRCLEVBQU9wRCxJQUNYb0UsR0FBU08sT0FBUyxXQUlkdkIsRUFBS3dCLFdBQWFSLEVBQVNTLE1BQVF6QixFQUFLSyxhQUN4Q0wsRUFBSzBCLFlBQWNWLEVBQVNXLE9BQVMzQixFQUFLSyxZQUMxQyxLQUFLLEdBQXNCSCxHQUFTZCxFQUFVZ0IsRUFBckN2RSxFQUFJLEVBQUcrRixFQUFRLEVBQTRCL0YsRUFBSW1FLEVBQUtLLGFBQWN4RSxJQUN2RSxJQUFLLEdBQUlnRyxHQUFJLEVBQUdBLEVBQUk3QixFQUFLSyxhQUFjd0IsSUFBS0QsSUFBUyxDQUNqRFQsRUFBU2pELFNBQVNrRCxjQUFjLFVBQ2hDQyxFQUFVRixFQUFPRyxXQUFXLE1BQzVCcEIsRUFBVSxHQUFJcEQsT0FBTWdGLFFBQVFYLEdBQzVCRSxFQUFRVSxVQUFVZixFQUFVbkYsRUFBSW1FLEVBQUt3QixXQUFZSyxFQUFJN0IsRUFBSzBCLFlBQWExQixFQUFLd0IsV0FBWXhCLEVBQUswQixZQUFhLEVBQUcsRUFBR1AsRUFBT00sTUFBT04sRUFBT1EsUUFDakl6QixJQUNBQSxFQUFROEIsZ0JBRVo1QyxFQUFXLEdBQUl0QyxPQUFNdUMsbUJBQ2pCYyxJQUFLRCxFQUNMK0IsS0FBTW5GLE1BQU1vRixhQUVoQjlDLEVBQVMrQyxlQUVUL0IsRUFBTyxHQUFJdEQsT0FBTTBDLEtBQ2IsR0FBSTFDLE9BQU1zRixjQUFjcEMsRUFBS1csV0FBWVgsRUFBS1ksYUFFOUN4QixFQUdKLElBQUlpRCxHQUFTQyxLQUFLRCxRQUNsQixJQUFJQSxFQUFTckMsRUFBS1MsaUJBQW1CVCxFQUFLSyxhQUFlTCxFQUFLSyxhQUFldUIsSUFBVTVCLEVBQUtTLGdCQUFrQixFQUFHLENBQzdHLEdBQUk4QixJQUFLdkMsRUFBS2xCLFFBQVUsRUFBSWtCLEVBQUtXLFdBQWEsRUFBSTJCLEtBQUtELFVBQVlyQyxFQUFLbEIsUUFBVWtCLEVBQUtXLFlBQ25GNkIsR0FBS3hDLEVBQUtsQixRQUFVLEVBQUlrQixFQUFLWSxZQUFjLEVBQUkwQixLQUFLRCxVQUFZckMsRUFBS2xCLFFBQVVrQixFQUFLWSxZQUN4RlIsR0FBS3FDLFNBQVNGLEVBQUlELEtBQUtJLEdBQUssRUFDNUJ0QyxFQUFLL0MsU0FBU0MsSUFBSWdGLEtBQUtLLE1BQU1KLEdBQUksR0FBS0QsS0FBS0ssTUFBTUgsR0FDakQsSUFBSUksR0FBWXhDLEVBQUt5QyxPQUNyQjdDLEdBQUtjLFFBQVFWLEVBQUtqRyxJQUFNeUksRUFDeEJBLEVBQVVILFNBQVNGLEVBQUksRUFDdkJLLEVBQVV4RCxTQUFXLEdBQUl0QyxPQUFNdUMsbUJBQzNCeUQsTUFBTyxRQUNQYixLQUFNbkYsTUFBTW9GLGFBRWhCVSxFQUFVdkYsU0FBU0MsSUFBSXpCLEVBQUVtRSxFQUFLVyxXQUFhWCxFQUFLTyxZQUFjLEVBQUlQLEVBQUtXLFdBQWEsRUFBRyxFQUFJWCxFQUFLUSxhQUFlUixFQUFLWSxZQUFjLEVBQUlpQixFQUFJN0IsRUFBS1ksbUJBQy9JWixFQUFLbkQsTUFBTTZDLElBQUlrRCxHQUNmNUMsRUFBS1Msa0JBQ0xULEVBQUtVLGNBQWNxQyxLQUFLM0MsRUFBS2pHLElBQzdCNkYsRUFBS2UsY0FBY1gsRUFBS2pHLElBQU1nSCxNQUU5QmYsR0FBSy9DLFNBQVNDLElBQUl6QixFQUFJbUUsRUFBS1csV0FBYVgsRUFBS08sWUFBYyxFQUFJUCxFQUFLVyxXQUFhLEVBQUcsRUFBSVgsRUFBS1EsYUFBZVIsRUFBS1ksWUFBYyxFQUFJaUIsRUFBSTdCLEVBQUtZLGtCQUdoSlosR0FBS3BCLFNBQVNtRSxLQUFLM0MsR0FDbkJKLEVBQUtuRCxNQUFNNkMsSUFBSVUsUUhrRzFCakUsSUFBSyxTQUNMWCxNQUFPLFNHNUZMd0gsR0FFSHBHLEtBQUtvQyxXQUFhZ0UsRUFFbEJwRyxLQUFLeUIsVUFBVTRFLGNBQWNyRyxLQUFLMkIsTUFBTzNCLEtBQUtJLE9BQzlDLElBQUlrRyxHQUFhdEcsS0FBS3lCLFVBQVU4RSxpQkFBaUJ2RyxLQUFLQyxNQUFNdUcsU0FFNUQsSUFEQXhHLEtBQUsyQixNQUFNZ0UsRUFBSTNGLEtBQUsyQixNQUFNa0IsRUFBSTRELE9BQzFCSCxFQUFXcEgsT0FBUyxFQUFHLENBRXZCLEdBQUl3SCxNQUZtQkMsS0FBQUMsS0FBQUMsRUFBQUosTUFBQSxLQUd2QixPQUFBSyxHQUFBQyxFQUFpQi9HLEtBQUtnQyxTQUF0QmdGLE9BQUFDLGNBQUFOLEdBQUFHLEVBQUFDLEVBQUFHLFFBQUFDLE1BQUFSLEtBQWdDLElBQXZCbkQsR0FBdUJzRCxFQUFBbEksS0FFeEJvQixNQUFLOEQsY0FBY3NELFFBQVE1RCxFQUFLakcsUUFBWWlHLEVBQUtqRyxJQUFNK0ksRUFBVyxHQUFHZSxPQUFPOUosS0FDckQsT0FBcEJ5QyxLQUFLaUUsZUFDSmpFLEtBQUtzSCxjQUNMdEgsS0FBS2lFLGFBQWFzRCxZQUV0QnZILEtBQUtpRSxhQUFlVCxFQUNwQnhELEtBQUsyQixNQUFNNkYsUUFBUUMsVUFBWSxLQUMvQmYsS0FFQWxELEVBQUsrRCxXQUNMakcsU0FBU29HLGVBQWUsT0FBT2xHLFlBQVl4QixLQUFLbUUsY0FBY1gsRUFBS2pHLE9BZnBELE1BQUFvSyxHQUFBZixLQUFBQyxFQUFBYyxFQUFBLGFBQUFoQixHQUFBSSwyQkFBQSxXQUFBSCxFQUFBLEtBQUFDLElBa0J2QixHQUFHN0csS0FBS2lFLGNBQWdCakUsS0FBS2tFLFFBQVFsRSxLQUFLaUUsYUFBYTFHLElBQUlBLElBQU0rSSxFQUFXLEdBQUdlLE9BQU85SixHQUFHLENBQ3JGLEdBQUlxSyxHQUFJdEIsRUFBVyxHQUFHZSxPQUFPNUcsUUFDN0JULE1BQUtpRSxhQUFheEQsU0FBU0MsSUFBSWtILEVBQUVqQyxFQUFFaUMsRUFBRS9FLEVBQUUrRSxFQUFFaEMsR0FDekM1RixLQUFLaUUsYUFBYTRCLFNBQVNuRixJQUFJLEVBQUUsRUFBRSxHQUNuQ1YsS0FBS2tFLFFBQVFsRSxLQUFLaUUsYUFBYTFHLElBQUlrRCxTQUFTbUYsR0FBSyxFQUNqRDVGLEtBQUtpRSxhQUFhc0QsV0FDbEJ2SCxLQUFLMkIsTUFBTTZGLFFBQVFDLFVBQVksS0FFL0J6SCxLQUFLOEQsY0FBYytELE9BQU83SCxLQUFLOEQsY0FBY3NELFFBQVFwSCxLQUFLaUUsYUFBYTFHLElBQUksR0FFM0V5QyxLQUFLc0gsY0FDTHRILEtBQUtpRSxhQUFlLEtBQ1ksR0FBN0JqRSxLQUFLOEQsY0FBYzVFLFdBQ2xCWSxlQUNJZ0ksTUFBTSxNQUNOQyxLQUFNLHNCQUNOQyxrQkFBbUIsT0FJNUJoSSxLQUFLaUUsZUFBaUJ5QyxJQUNyQjFHLEtBQUsyQixNQUFNNkYsUUFBUUMsVUFBWSxLQUMvQnpILEtBQUtpRSxhQUFhc0QsV0FDbEJ2SCxLQUFLc0gsY0FDTHRILEtBQUtpRSxhQUFlLE1BSTVCakUsS0FBS1csU0FBU3NILFNBQ2RqSSxLQUFLYSxTQUFTeEMsT0FBTzJCLEtBQUtDLE1BQU1ELEtBQUtJLFFBRXJDOEgsc0JBQXNCbEksS0FBSzNCLFdIcUgxQmtCLElBQUssV0FDTFgsTUFBTyxTR3BISHVKLEdBQ0xuSSxLQUFLSSxPQUFPZ0ksT0FBUzlILE9BQU9DLFdBQWFELE9BQU9FLFlBQ3REUixLQUFLSSxPQUFPaUkseUJBQ1pySSxLQUFLYSxTQUFTSyxRQUFTWixPQUFPQyxXQUFZRCxPQUFPRSxnQkh1SDFDakIsSUFBSyxjQUNMWCxNQUFPLFdHbkhSLElBRkEsR0FBSTJGLEdBQVNqRCxTQUFTZ0gsY0FBYyxlQUNoQ0MsRUFBTWpILFNBQVNvRyxlQUFlLE9BQ3BCLE1BQVJuRCxHQUNGZ0UsRUFBSUMsWUFBWWpFLEdBQ2hCQSxFQUFTakQsU0FBU2dILGNBQWMsbUJIMkhoQ3ZJLElBR1gxQyxjR3hWb0IwQyxHSDRWZixTQUFTekMsRUFBUUQsR0FFdEIsWUFRQSxTQUFTaUIsR0FBZ0JDLEVBQVVDLEdBQWUsS0FBTUQsWUFBb0JDLElBQWdCLEtBQU0sSUFBSUMsV0FBVSxxQ0FFaEgsUUFBU2dLLEdBQTJCckYsRUFBTTNGLEdBQVEsSUFBSzJGLEVBQVEsS0FBTSxJQUFJc0YsZ0JBQWUsNERBQWdFLFFBQU9qTCxHQUF5QixnQkFBVEEsSUFBcUMsa0JBQVRBLEdBQThCMkYsRUFBUDNGLEVBRWxPLFFBQVNrTCxHQUFVQyxFQUFVQyxHQUFjLEdBQTBCLGtCQUFmQSxJQUE0QyxPQUFmQSxFQUF1QixLQUFNLElBQUlwSyxXQUFVLGlFQUFvRW9LLEdBQWVELEdBQVNsSixVQUFZaEIsT0FBT29LLE9BQU9ELEdBQWNBLEVBQVduSixXQUFhcUosYUFBZW5LLE1BQU9nSyxFQUFVeEosY0FBbUJFLFlBQWdCRCxtQkFBNkJ3SixJQUFZbkssT0FBT3NLLGVBQWlCdEssT0FBT3NLLGVBQWVKLEVBQVVDLEdBQWNELEVBQVNLLFVBQVlKLEdBVmplbkssT0FBT0MsZUFBZXRCLEVBQVMsY0FDM0J1QixVQUdKLElBQUlDLEdBQWUsV0FBYyxRQUFTQyxHQUFpQkMsRUFBUUMsR0FBUyxJQUFLLEdBQUlDLEdBQUksRUFBR0EsRUFBSUQsRUFBTUUsT0FBUUQsSUFBSyxDQUFFLEdBQUlFLEdBQWFILEVBQU1DLEVBQUlFLEdBQVdDLFdBQWFELEVBQVdDLGVBQXFCRCxFQUFXRSxnQkFBeUIsU0FBV0YsS0FBWUEsRUFBV0csYUFBaUJaLE9BQU9DLGVBQWVJLEVBQVFJLEVBQVdJLElBQUtKLElBQWlCLE1BQU8sVUFBVVgsRUFBYWdCLEVBQVlDLEdBQWlKLE1BQTlIRCxJQUFZVixFQUFpQk4sRUFBWWtCLFVBQVdGLEdBQWlCQyxHQUFhWCxFQUFpQk4sRUFBYWlCLEdBQXFCakIsTUl4VzVnQjBLLEVKZ1hSLFNBQVVDLEdJL1duQixRQUFBRCxHQUFZbEssR0FBTVYsRUFBQTBCLEtBQUFrSixFQUFBLElBQUFFLEdBQUFYLEVBQUF6SSxLQUFBdEIsT0FBQTJLLGVBQUFILEdBQUF6TCxLQUFBdUMsS0FDUmhCLEdBRFEsT0FFZG9LLEdBQUt6RCxFQUFJYyxPQUNUMkMsRUFBS3ZHLEVBQUk0RCxPQUVUMkMsRUFBSzVCLFFBQVVsRyxTQUFTb0csZUFBZSxZQUN2QzBCLEVBQUtFLFNBQVdoSSxTQUFTb0csZUFBZSxhQUN4QzBCLEVBQUs1QixRQUFRckYsaUJBQWlCLFFBQVFpSCxFQUFLRyxXQUFXMUgsS0FBaEJ1SCxPQVB4QkEsRUpvWmpCLE1BcENBVCxHQUFVTyxFQUFPQyxHQWlCakJ0SyxFQUFhcUssSUFDVDNKLElBQUssZUFDTFgsTUFBTyxTSXpYRTRLLEdBSVZ4SixLQUFLMkYsRUFBTTZELEVBQU1DLFFBQVVuSixPQUFPQyxXQUFlLEVBQUksRUFDckRQLEtBQUs2QyxFQUErQyxJQUF2QzJHLEVBQU1FLFFBQVVwSixPQUFPRSxhQUFvQixLSjZYdkRqQixJQUFLLGFBQ0xYLE1BQU8sU0kzWEE0SyxHQUNSeEosS0FBSzJGLEVBQU0sSUFBYSxFQUN4QjNGLEtBQUs2QyxPQUFzQixNSmdZdkJxRyxHSXJadUJoSixNQUFNeUosUUp3WnhDdE0sY0l4Wm9CNkwsR0o0WmYsU0FBUzVMLEVBQVFELEVBQVNILEdLNVpoQ0ksRUFBQUQsUUFBQUgsRUFBQVUsRUFBQSxrQ0xrYU0sU0FBU04sRUFBUUQsR01sYXZCQyxFQUFBRCxRQUFBdU0sTU53YU0sU0FBU3RNLEVBQVFELEdPeGF2QkMsRUFBQUQiLCJmaWxlIjoiVlJQdXp6bGUuYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqKioqKi8gKGZ1bmN0aW9uKG1vZHVsZXMpIHsgLy8gd2VicGFja0Jvb3RzdHJhcFxuLyoqKioqKi8gXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuLyoqKioqKi8gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuLyoqKioqKi8gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKVxuLyoqKioqKi8gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4vKioqKioqLyBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuLyoqKioqKi8gXHRcdFx0ZXhwb3J0czoge30sXG4vKioqKioqLyBcdFx0XHRpZDogbW9kdWxlSWQsXG4vKioqKioqLyBcdFx0XHRsb2FkZWQ6IGZhbHNlXG4vKioqKioqLyBcdFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4vKioqKioqLyBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbi8qKioqKiovIFx0XHRtb2R1bGUubG9hZGVkID0gdHJ1ZTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbi8qKioqKiovIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4vKioqKioqLyBcdH1cbi8qKioqKiovXG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiL1ZSUHV6emxlL3B1YmxpYy9cIjtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLyoqKioqKi8gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygwKTtcbi8qKioqKiovIH0pXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuLyoqKioqKi8gKFtcbi8qIDAgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdFwidXNlIHN0cmljdFwiO1xuXHRcblx0X193ZWJwYWNrX3JlcXVpcmVfXyg1KTtcblx0XG5cdHZhciBfZ2FtZSA9IF9fd2VicGFja19yZXF1aXJlX18oMSk7XG5cdFxuXHR2YXIgX2dhbWUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ2FtZSk7XG5cdFxuXHRmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXHRcblx0dmFyIGdhbWUgPSBuZXcgX2dhbWUyLmRlZmF1bHQoKTtcblx0XG5cdHZhciBsb29wID0gZnVuY3Rpb24gbG9vcCgpIHtcblx0ICAgIGdhbWUucmVuZGVyKCk7XG5cdCAgICAvLyByZXF1ZXN0QW5pbWF0aW9uRnJhbWUobG9vcClcblx0fTtcblx0bG9vcCgpO1xuXG4vKioqLyB9LFxuLyogMSAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0XCJ1c2Ugc3RyaWN0XCI7XG5cdFxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcblx0ICAgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRcblx0dmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblx0XG5cdHZhciBfbW91c2UgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpO1xuXHRcblx0dmFyIF9tb3VzZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9tb3VzZSk7XG5cdFxuXHR2YXIgX3N3ZWV0YWxlcnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpO1xuXHRcblx0dmFyIF9zd2VldGFsZXJ0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3N3ZWV0YWxlcnQpO1xuXHRcblx0ZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblx0XG5cdGZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cdFxuXHR2YXIgR2FtZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIGZ1bmN0aW9uIEdhbWUoKSB7XG5cdCAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEdhbWUpO1xuXHRcblx0ICAgICAgICAvLyBDcmVhdGUgYSB0aHJlZS5qcyBzY2VuZS5cblx0ICAgICAgICB0aGlzLnNjZW5lID0gbmV3IFRIUkVFLlNjZW5lKCk7XG5cdFxuXHQgICAgICAgIC8vIENyZWF0ZSBhIHRocmVlLmpzIGNhbWVyYS5cblx0ICAgICAgICB0aGlzLmNhbWVyYSA9IG5ldyBUSFJFRS5QZXJzcGVjdGl2ZUNhbWVyYSg3NSwgd2luZG93LmlubmVyV2lkdGggLyB3aW5kb3cuaW5uZXJIZWlnaHQsIDAuMSwgMTAwMDApO1xuXHRcblx0ICAgICAgICB0aGlzLmNhbWVyYS5wb3NpdGlvbi5zZXQoMCwgMTAsIDApO1xuXHQgICAgICAgIHRoaXMuY29udHJvbHMgPSBuZXcgVEhSRUUuRGV2aWNlT3JpZW50YXRpb25Db250cm9scyh0aGlzLmNhbWVyYSk7XG5cdFxuXHQgICAgICAgIHRoaXMucmVuZGVyZXIgPSBuZXcgVEhSRUUuV2ViR0xSZW5kZXJlcih7XG5cdCAgICAgICAgICAgIGFudGlhbGlhczogdHJ1ZVxuXHQgICAgICAgIH0pO1xuXHQgICAgICAgIHRoaXMucmVuZGVyZXIuc2V0UGl4ZWxSYXRpbyh3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyk7XG5cdCAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRTaXplKHdpbmRvdy5pbm5lcldpZHRoLCB3aW5kb3cuaW5uZXJIZWlnaHQpO1xuXHQgICAgICAgIHRoaXMucmVuZGVyZXIuZG9tRWxlbWVudC5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7XG5cdCAgICAgICAgdGhpcy5yZW5kZXJlci5kb21FbGVtZW50LnN0eWxlLnRvcCA9IDA7XG5cdCAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh0aGlzLnJlbmRlcmVyLmRvbUVsZW1lbnQpO1xuXHRcblx0ICAgICAgICAvLyByYXljYXN0ZXJcblx0ICAgICAgICB0aGlzLnJheWNhc3RlciA9IG5ldyBUSFJFRS5SYXljYXN0ZXIoKTtcblx0ICAgICAgICB0aGlzLm1vdXNlID0gbmV3IF9tb3VzZTIuZGVmYXVsdCgpO1xuXHQgICAgICAgIC8vYmluZCB0aGlzXG5cdCAgICAgICAgdGhpcy5vblRleHR1cmVMb2FkZWQgPSB0aGlzLm9uVGV4dHVyZUxvYWRlZC5iaW5kKHRoaXMpO1xuXHQgICAgICAgIHRoaXMub25SZXNpemUgPSB0aGlzLm9uUmVzaXplLmJpbmQodGhpcyk7XG5cdCAgICAgICAgdGhpcy5yZW5kZXIgPSB0aGlzLnJlbmRlci5iaW5kKHRoaXMpO1xuXHQgICAgICAgIHRoaXMucGxhY2VQaWVjZXMgPSB0aGlzLnBsYWNlUGllY2VzLmJpbmQodGhpcyk7XG5cdCAgICAgICAgLy9cblx0ICAgICAgICB0aGlzLm1lc2hMaXN0ID0gW107XG5cdCAgICAgICAgdGhpcy5sb2dGbGFnID0gdHJ1ZTtcblx0ICAgICAgICAvLyBBZGQgYSByZXBlYXRpbmcgZ3JpZCBhcyBhIHNreWJveC5cblx0ICAgICAgICB0aGlzLmJveFNpemUgPSA1MDtcblx0ICAgICAgICAvLyB0aGlzLmxvYWRlciA9IG5ldyBUSFJFRS5UZXh0dXJlTG9hZGVyKClcblx0ICAgICAgICAvLyB0aGlzLmxvYWRlci5sb2FkKFwicHVibGljL2ltYWdlcy9ib3gucG5nXCIsIHRoaXMub25UZXh0dXJlTG9hZGVkKVxuXHQgICAgICAgIC8vIGxldCB0ZXh0dXJlID0gbmV3IFRIUkVFLlRleHR1cmUoKVxuXHQgICAgICAgIHRoaXMub25UZXh0dXJlTG9hZGVkKCk7XG5cdCAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJyZXNpemVcIiwgdGhpcy5vblJlc2l6ZSwgdHJ1ZSk7XG5cdCAgICAgICAgLy8gd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJ2cmRpc3BsYXlwcmVzZW50Y2hhbmdlXCIsIHRoaXMub25SZXNpemUsIHRydWUpXG5cdCAgICAgICAgdGhpcy5sYXN0UmVuZGVyID0gMDtcblx0ICAgICAgICB0aGlzLmRpc3BsYXkgPSBudWxsO1xuXHQgICAgfVxuXHRcblx0ICAgIF9jcmVhdGVDbGFzcyhHYW1lLCBbe1xuXHQgICAgICAgIGtleTogXCJvblRleHR1cmVMb2FkZWRcIixcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gb25UZXh0dXJlTG9hZGVkKCkge1xuXHQgICAgICAgICAgICAvLyB0ZXh0dXJlLndyYXBTID0gVEhSRUUuUmVwZWF0V3JhcHBpbmdcblx0ICAgICAgICAgICAgLy8gdGV4dHVyZS53cmFwVCA9IFRIUkVFLlJlcGVhdFdyYXBwaW5nXG5cdCAgICAgICAgICAgIC8vIHRleHR1cmUucmVwZWF0LnNldCh0aGlzLmJveFNpemUsIHRoaXMuYm94U2l6ZSlcblx0XG5cdCAgICAgICAgICAgIHZhciBnZW9tZXRyeSA9IG5ldyBUSFJFRS5Cb3hHZW9tZXRyeSh0aGlzLmJveFNpemUsIHRoaXMuYm94U2l6ZSwgdGhpcy5ib3hTaXplKTtcblx0ICAgICAgICAgICAgLy8gbGV0IG1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hCYXNpY01hdGVyaWFsKHsgY29sb3I6IDB4ZmYwMGZmLCBzaWRlOiBUSFJFRS5CYWNrU2lkZSAsIHdpcmVmcmFtZTogdHJ1ZX0gKVxuXHQgICAgICAgICAgICB2YXIgbWF0ZXJpYWwgPSBuZXcgVEhSRUUuTWVzaEJhc2ljTWF0ZXJpYWwoeyBhbHBoYU1hcDogMHgwMDAwMCB9KTtcblx0ICAgICAgICAgICAgLy9cblx0ICAgICAgICAgICAgLy8gQWxpZ24gdGhlIHNreWJveCB0byB0aGUgZmxvb3IgKHdoaWNoIGlzIGF0IHk9MCkuXG5cdCAgICAgICAgICAgIHRoaXMuc2t5Ym94ID0gbmV3IFRIUkVFLk1lc2goZ2VvbWV0cnksIG1hdGVyaWFsKTtcblx0ICAgICAgICAgICAgdGhpcy5za3lib3gucG9zaXRpb24ueSA9IHRoaXMuYm94U2l6ZSAvIDI7XG5cdCAgICAgICAgICAgIHRoaXMuc2NlbmUuYWRkKHRoaXMuc2t5Ym94KTtcblx0ICAgICAgICAgICAgdGhpcy5wbGFjZVBpZWNlcygpO1xuXHQgICAgICAgICAgICB0aGlzLnBsYWNlU3BoZXJlKCk7XG5cdCAgICAgICAgfVxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogXCJwbGFjZVNwaGVyZVwiLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBwbGFjZVNwaGVyZSgpIHtcblx0ICAgICAgICAgICAgdmFyIGdlb21ldHJ5ID0gbmV3IFRIUkVFLlNwaGVyZUdlb21ldHJ5KDEwMCwgMTAwLCAxMDApO1xuXHQgICAgICAgICAgICBnZW9tZXRyeS5zY2FsZSgtMSwgMSwgMSk7XG5cdCAgICAgICAgICAgIC8vIGdlb21ldHJ5LnNjYWxlKCAtIDEsIDEsIDEgKTtcblx0ICAgICAgICAgICAgLy8gdmFyIHNwaGVyZSA9IHJlcXVpcmUoXCIuLi8uLi9wdWJsaWMvaW1hZ2VzL3NwaGVyZSAoMikuanBnXCIpXG5cdCAgICAgICAgICAgIHZhciBsb2FkZXIgPSBuZXcgVEhSRUUuVGV4dHVyZUxvYWRlcigpO1xuXHQgICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG5cdCAgICAgICAgICAgIGxvYWRlci5sb2FkKFwicHVibGljL2ltYWdlcy9zcGhlcmUgKDIpLmpwZ1wiLCBmdW5jdGlvbiAodGV4dHVyZSkge1xuXHQgICAgICAgICAgICAgICAgdmFyIG1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hCYXNpY01hdGVyaWFsKHtcblx0ICAgICAgICAgICAgICAgICAgICBtYXA6IHRleHR1cmVcblx0ICAgICAgICAgICAgICAgIH0pO1xuXHRcblx0ICAgICAgICAgICAgICAgIHZhciBtZXNoID0gbmV3IFRIUkVFLk1lc2goZ2VvbWV0cnksIG1hdGVyaWFsKTtcblx0ICAgICAgICAgICAgICAgIG1lc2gucG9zaXRpb24uc2V0KDAsIDAsIDEwKTtcblx0ICAgICAgICAgICAgICAgIHNlbGYuc2NlbmUuYWRkKG1lc2gpO1xuXHQgICAgICAgICAgICB9KTtcblx0ICAgICAgICB9XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiBcInBsYWNlUGllY2VzXCIsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHBsYWNlUGllY2VzKCkge1xuXHRcblx0ICAgICAgICAgICAgdGhpcy5jb2x1bW5OdW1iZXIgPSA0O1xuXHQgICAgICAgICAgICB0aGlzLnBpZWNlTnVtYmVyID0gdGhpcy5jb2x1bW5OdW1iZXIgKiB0aGlzLmNvbHVtbk51bWJlcjtcblx0ICAgICAgICAgICAgdGhpcy5zY2FsZWRXaWR0aCA9IDE2O1xuXHQgICAgICAgICAgICB0aGlzLnNjYWxlZEhlaWdodCA9IDk7XG5cdCAgICAgICAgICAgIHRoaXMuZnJlZVBpZWNlTnVtYmVyID0gdGhpcy5waWVjZU51bWJlciAqIDEgLyAyO1xuXHQgICAgICAgICAgICB0aGlzLmZyZWVQaWVjZUxpc3QgPSBbXTtcblx0ICAgICAgICAgICAgdGhpcy5wbGFuZVdpZHRoID0gdGhpcy5zY2FsZWRXaWR0aCAvIHRoaXMuY29sdW1uTnVtYmVyO1xuXHQgICAgICAgICAgICB0aGlzLnBsYW5lSGVpZ2h0ID0gdGhpcy5zY2FsZWRIZWlnaHQgLyB0aGlzLmNvbHVtbk51bWJlcjtcblx0ICAgICAgICAgICAgdGhpcy5zZWxlY3RlZE1lc2ggPSBudWxsOyAvL3RoZSBsYXN0IGNsaWNrZWQgbWVzaElkXG5cdCAgICAgICAgICAgIHRoaXMuaG9sZE1hcCA9IHt9O1xuXHQgICAgICAgICAgICB0aGlzLm1lc2hDYW52YXNNYXAgPSB7fTtcblx0ICAgICAgICAgICAgdmFyIGltYWdlT2JqID0gbmV3IEltYWdlKCk7XG5cdCAgICAgICAgICAgIGltYWdlT2JqLnNyYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7XG5cdCAgICAgICAgICAgIHZhciBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpO1xuXHQgICAgICAgICAgICB2YXIgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XG5cdCAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcblx0ICAgICAgICAgICAgaW1hZ2VPYmoub25sb2FkID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgICAgICAgLy8gbGV0IHdzID0gKGNhbnZhcy53aWR0aCApIC8gaW1hZ2VPYmoud2lkdGhcblx0ICAgICAgICAgICAgICAgIC8vIGxldCBocyA9IChjYW52YXMuaGVpZ2h0KSAvIGltYWdlT2JqLmhlaWdodFxuXHQgICAgICAgICAgICAgICAgLy8gc2VsZi5zY2FsZSA9IE1hdGgubWluKHdzLCBocylcblx0ICAgICAgICAgICAgICAgIHNlbGYucGllY2VXaWR0aCA9IGltYWdlT2JqLndpZHRoIC8gc2VsZi5jb2x1bW5OdW1iZXI7XG5cdCAgICAgICAgICAgICAgICBzZWxmLnBpZWNlSGVpZ2h0ID0gaW1hZ2VPYmouaGVpZ2h0IC8gc2VsZi5jb2x1bW5OdW1iZXI7XG5cdCAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgaW5kZXggPSAwLCB0ZXh0dXJlLCBtYXRlcmlhbCwgbWVzaDsgaSA8IHNlbGYuY29sdW1uTnVtYmVyOyBpKyspIHtcblx0ICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHNlbGYuY29sdW1uTnVtYmVyOyBqKyssIGluZGV4KyspIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIHRleHR1cmUgPSBuZXcgVEhSRUUuVGV4dHVyZShjYW52YXMpO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0LmRyYXdJbWFnZShpbWFnZU9iaiwgaSAqIHNlbGYucGllY2VXaWR0aCwgaiAqIHNlbGYucGllY2VIZWlnaHQsIHNlbGYucGllY2VXaWR0aCwgc2VsZi5waWVjZUhlaWdodCwgMCwgMCwgY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRleHR1cmUpIC8vIGNoZWNrcyBpZiB0ZXh0dXJlIGV4aXN0c1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dHVyZS5uZWVkc1VwZGF0ZSA9IHRydWU7XG5cdFxuXHQgICAgICAgICAgICAgICAgICAgICAgICBtYXRlcmlhbCA9IG5ldyBUSFJFRS5NZXNoQmFzaWNNYXRlcmlhbCh7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXA6IHRleHR1cmUsXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaWRlOiBUSFJFRS5Eb3VibGVTaWRlXG5cdCAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICBtYXRlcmlhbC50cmFuc3BhcmVudCA9IGZhbHNlO1xuXHRcblx0ICAgICAgICAgICAgICAgICAgICAgICAgbWVzaCA9IG5ldyBUSFJFRS5NZXNoKG5ldyBUSFJFRS5QbGFuZUdlb21ldHJ5KHNlbGYucGxhbmVXaWR0aCwgc2VsZi5wbGFuZUhlaWdodCksXG5cdCAgICAgICAgICAgICAgICAgICAgICAgIC8vIG5ldyBUSFJFRS5TcGhlcmVHZW9tZXRyeSg1MCw1MCw1MCwwLE1hdGguUEkvMTYsTWF0aC5QSS8yLE1hdGguUEkvMjQpLFxuXHQgICAgICAgICAgICAgICAgICAgICAgICBtYXRlcmlhbCk7XG5cdFxuXHQgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmFuZG9tID0gTWF0aC5yYW5kb20oKTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJhbmRvbSA8IHNlbGYuZnJlZVBpZWNlTnVtYmVyIC8gKHNlbGYuY29sdW1uTnVtYmVyICogc2VsZi5jb2x1bW5OdW1iZXIgLSBpbmRleCkgJiYgc2VsZi5mcmVlUGllY2VOdW1iZXIgPiAwKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgeCA9IC1zZWxmLmJveFNpemUgLyAyICsgc2VsZi5wbGFuZVdpZHRoIC8gMiArIE1hdGgucmFuZG9tKCkgKiAoc2VsZi5ib3hTaXplIC0gc2VsZi5wbGFuZVdpZHRoKTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB6ID0gLXNlbGYuYm94U2l6ZSAvIDIgKyBzZWxmLnBsYW5lSGVpZ2h0IC8gMiArIE1hdGgucmFuZG9tKCkgKiAoc2VsZi5ib3hTaXplIC0gc2VsZi5wbGFuZUhlaWdodCk7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNoLnJvdGF0aW9uLnggPSBNYXRoLlBJIC8gMjtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc2gucG9zaXRpb24uc2V0KE1hdGgucm91bmQoeCksIDAuNSwgTWF0aC5yb3VuZCh6KSk7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYmxhbmtNZXNoID0gbWVzaC5jbG9uZSgpO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5ob2xkTWFwW21lc2guaWRdID0gYmxhbmtNZXNoO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxhbmtNZXNoLnJvdGF0aW9uLnggPSAwO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxhbmtNZXNoLm1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hCYXNpY01hdGVyaWFsKHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogMHg4MDgwODAsXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2lkZTogVEhSRUUuRG91YmxlU2lkZVxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICBibGFua01lc2gucG9zaXRpb24uc2V0KGkgKiBzZWxmLnBsYW5lV2lkdGggLSBzZWxmLnNjYWxlZFdpZHRoIC8gMiArIHNlbGYucGxhbmVXaWR0aCAvIDIsIDUgKyBzZWxmLnNjYWxlZEhlaWdodCAtIHNlbGYucGxhbmVIZWlnaHQgLyAyIC0gaiAqIHNlbGYucGxhbmVIZWlnaHQsIC05Ljk5KTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuc2NlbmUuYWRkKGJsYW5rTWVzaCk7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmZyZWVQaWVjZU51bWJlci0tO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5mcmVlUGllY2VMaXN0LnB1c2gobWVzaC5pZCk7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLm1lc2hDYW52YXNNYXBbbWVzaC5pZF0gPSBjYW52YXM7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNoLnBvc2l0aW9uLnNldChpICogc2VsZi5wbGFuZVdpZHRoIC0gc2VsZi5zY2FsZWRXaWR0aCAvIDIgKyBzZWxmLnBsYW5lV2lkdGggLyAyLCA1ICsgc2VsZi5zY2FsZWRIZWlnaHQgLSBzZWxmLnBsYW5lSGVpZ2h0IC8gMiAtIGogKiBzZWxmLnBsYW5lSGVpZ2h0LCAtOS45OSk7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgICAgICAgICAgLy8gbWVzaC5wb3NpdGlvbi5zZXQoMCwgMiwtOSlcblx0ICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5tZXNoTGlzdC5wdXNoKG1lc2gpO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnNjZW5lLmFkZChtZXNoKTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2codHlwZW9mIHRoaXMuc2NlbmUpXG5cdCAgICAgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9O1xuXHQgICAgICAgIH1cblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6IFwicmVuZGVyXCIsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcih0aW1lc3RhbXApIHtcblx0ICAgICAgICAgICAgLy8gdmFyIGRlbHRhID0gTWF0aC5taW4odGltZXN0YW1wIC0gdGhpcy5sYXN0UmVuZGVyLCA1MDApXG5cdCAgICAgICAgICAgIHRoaXMubGFzdFJlbmRlciA9IHRpbWVzdGFtcDtcblx0ICAgICAgICAgICAgLy/lpITnkIbpvKDmoIfngrnlh7tcblx0ICAgICAgICAgICAgdGhpcy5yYXljYXN0ZXIuc2V0RnJvbUNhbWVyYSh0aGlzLm1vdXNlLCB0aGlzLmNhbWVyYSk7XG5cdCAgICAgICAgICAgIHZhciBpbnRlcnNlY3RzID0gdGhpcy5yYXljYXN0ZXIuaW50ZXJzZWN0T2JqZWN0cyh0aGlzLnNjZW5lLmNoaWxkcmVuKTtcblx0ICAgICAgICAgICAgdGhpcy5tb3VzZS54ID0gdGhpcy5tb3VzZS55ID0gdW5kZWZpbmVkO1xuXHQgICAgICAgICAgICBpZiAoaW50ZXJzZWN0cy5sZW5ndGggPiAwKSB7XG5cdCAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhpbnRlcnNlY3RzKVxuXHQgICAgICAgICAgICAgICAgdmFyIGNsaWNrRmxhZyA9IGZhbHNlO1xuXHQgICAgICAgICAgICAgICAgdmFyIF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24gPSB0cnVlO1xuXHQgICAgICAgICAgICAgICAgdmFyIF9kaWRJdGVyYXRvckVycm9yID0gZmFsc2U7XG5cdCAgICAgICAgICAgICAgICB2YXIgX2l0ZXJhdG9yRXJyb3IgPSB1bmRlZmluZWQ7XG5cdFxuXHQgICAgICAgICAgICAgICAgdHJ5IHtcblx0ICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBfaXRlcmF0b3IgPSB0aGlzLm1lc2hMaXN0W1N5bWJvbC5pdGVyYXRvcl0oKSwgX3N0ZXA7ICEoX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiA9IChfc3RlcCA9IF9pdGVyYXRvci5uZXh0KCkpLmRvbmUpOyBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uID0gdHJ1ZSkge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbWVzaCA9IF9zdGVwLnZhbHVlO1xuXHRcblx0XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmZyZWVQaWVjZUxpc3QuaW5kZXhPZihtZXNoLmlkKSA+IC0xICYmIG1lc2guaWQgPT0gaW50ZXJzZWN0c1swXS5vYmplY3QuaWQpIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnNlbGVjdGVkTWVzaCAhPT0gbnVsbCkge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2xlYXJDYW52YXMoKTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkTWVzaC52aXNpYmxlID0gdHJ1ZTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRNZXNoID0gbWVzaDtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubW91c2UucGlja0J0bi5pbm5lckhUTUwgPSBcIui0tOS4ilwiO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xpY2tGbGFnID0gdHJ1ZTtcblx0XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNoLnZpc2libGUgPSBmYWxzZTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicGluXCIpLmFwcGVuZENoaWxkKHRoaXMubWVzaENhbnZhc01hcFttZXNoLmlkXSk7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcblx0ICAgICAgICAgICAgICAgICAgICBfZGlkSXRlcmF0b3JFcnJvciA9IHRydWU7XG5cdCAgICAgICAgICAgICAgICAgICAgX2l0ZXJhdG9yRXJyb3IgPSBlcnI7XG5cdCAgICAgICAgICAgICAgICB9IGZpbmFsbHkge1xuXHQgICAgICAgICAgICAgICAgICAgIHRyeSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIGlmICghX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiAmJiBfaXRlcmF0b3IucmV0dXJuKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaXRlcmF0b3IucmV0dXJuKCk7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgICAgICB9IGZpbmFsbHkge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICBpZiAoX2RpZEl0ZXJhdG9yRXJyb3IpIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IF9pdGVyYXRvckVycm9yO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgICAgICAgIGlmICh0aGlzLnNlbGVjdGVkTWVzaCAmJiB0aGlzLmhvbGRNYXBbdGhpcy5zZWxlY3RlZE1lc2guaWRdLmlkID09IGludGVyc2VjdHNbMF0ub2JqZWN0LmlkKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgdmFyIHQgPSBpbnRlcnNlY3RzWzBdLm9iamVjdC5wb3NpdGlvbjtcblx0ICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkTWVzaC5wb3NpdGlvbi5zZXQodC54LCB0LnksIHQueik7XG5cdCAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZE1lc2gucm90YXRpb24uc2V0KDAsIDAsIDApO1xuXHQgICAgICAgICAgICAgICAgICAgIHRoaXMuaG9sZE1hcFt0aGlzLnNlbGVjdGVkTWVzaC5pZF0ucG9zaXRpb24ueiAtPSAxO1xuXHQgICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRNZXNoLnZpc2libGUgPSB0cnVlO1xuXHQgICAgICAgICAgICAgICAgICAgIHRoaXMubW91c2UucGlja0J0bi5pbm5lckhUTUwgPSBcIuaNoei1t1wiO1xuXHQgICAgICAgICAgICAgICAgICAgIC8v5Zyo5pyq5ou85oiQ5Zu+54mH5YiX6KGo5Lit5Y+W5Ye65b2T5YmN6aG5XG5cdCAgICAgICAgICAgICAgICAgICAgdGhpcy5mcmVlUGllY2VMaXN0LnNwbGljZSh0aGlzLmZyZWVQaWVjZUxpc3QuaW5kZXhPZih0aGlzLnNlbGVjdGVkTWVzaC5pZCksIDEpO1xuXHQgICAgICAgICAgICAgICAgICAgIC8v5riF5qWa5b2T5YmN6YCJ5Y+W55qE5Zu+5YOPXG5cdCAgICAgICAgICAgICAgICAgICAgdGhpcy5jbGVhckNhbnZhcygpO1xuXHQgICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRNZXNoID0gbnVsbDtcblx0ICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5mcmVlUGllY2VMaXN0Lmxlbmd0aCA9PSAwKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICgwLCBfc3dlZXRhbGVydDIuZGVmYXVsdCkoe1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IFwi5oGt5Zac77yBXCIsXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiBcIuaIkOWKn+aLvOWujOS6huS4gOW8oOWbvu+8jOWPr+aYr+aIkeS5n+S4jeS8mue7meS9oOa1gemHj1wiLFxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6IFwi5aW955qEXCJcblx0ICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRNZXNoICYmICFjbGlja0ZsYWcpIHtcblx0ICAgICAgICAgICAgICAgICAgICB0aGlzLm1vdXNlLnBpY2tCdG4uaW5uZXJIVE1MID0gXCLmjaHotbdcIjtcblx0ICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkTWVzaC52aXNpYmxlID0gdHJ1ZTtcblx0ICAgICAgICAgICAgICAgICAgICB0aGlzLmNsZWFyQ2FudmFzKCk7XG5cdCAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZE1lc2ggPSBudWxsO1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgICB0aGlzLmNvbnRyb2xzLnVwZGF0ZSgpO1xuXHQgICAgICAgICAgICB0aGlzLnJlbmRlcmVyLnJlbmRlcih0aGlzLnNjZW5lLCB0aGlzLmNhbWVyYSk7XG5cdFxuXHQgICAgICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy5yZW5kZXIpO1xuXHQgICAgICAgIH1cblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6IFwib25SZXNpemVcIixcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gb25SZXNpemUoZSkge1xuXHQgICAgICAgICAgICB0aGlzLmNhbWVyYS5hc3BlY3QgPSB3aW5kb3cuaW5uZXJXaWR0aCAvIHdpbmRvdy5pbm5lckhlaWdodDtcblx0ICAgICAgICAgICAgdGhpcy5jYW1lcmEudXBkYXRlUHJvamVjdGlvbk1hdHJpeCgpO1xuXHQgICAgICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFNpemUod2luZG93LmlubmVyV2lkdGgsIHdpbmRvdy5pbm5lckhlaWdodCk7XG5cdCAgICAgICAgfVxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogXCJjbGVhckNhbnZhc1wiLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjbGVhckNhbnZhcygpIHtcblx0ICAgICAgICAgICAgdmFyIGNhbnZhcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcGluIGNhbnZhc1wiKTtcblx0ICAgICAgICAgICAgdmFyIHBpbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicGluXCIpO1xuXHQgICAgICAgICAgICB3aGlsZSAoY2FudmFzICE9IG51bGwpIHtcblx0ICAgICAgICAgICAgICAgIHBpbi5yZW1vdmVDaGlsZChjYW52YXMpO1xuXHQgICAgICAgICAgICAgICAgY2FudmFzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwaW4gY2FudmFzXCIpO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHQgICAgfV0pO1xuXHRcblx0ICAgIHJldHVybiBHYW1lO1xuXHR9KCk7XG5cdFxuXHRleHBvcnRzLmRlZmF1bHQgPSBHYW1lO1xuXG4vKioqLyB9LFxuLyogMiAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cblx0XCJ1c2Ugc3RyaWN0XCI7XG5cdFxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcblx0ICAgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRcblx0dmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblx0XG5cdGZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cdFxuXHRmdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmICghc2VsZikgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpID8gY2FsbCA6IHNlbGY7IH1cblx0XG5cdGZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXHRcblx0dmFyIE1vdXNlID0gZnVuY3Rpb24gKF9USFJFRSRWZWN0b3IpIHtcblx0ICAgIF9pbmhlcml0cyhNb3VzZSwgX1RIUkVFJFZlY3Rvcik7XG5cdFxuXHQgICAgZnVuY3Rpb24gTW91c2UocHJvcHMpIHtcblx0ICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgTW91c2UpO1xuXHRcblx0ICAgICAgICB2YXIgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoTW91c2UpLmNhbGwodGhpcywgcHJvcHMpKTtcblx0XG5cdCAgICAgICAgX3RoaXMueCA9IHVuZGVmaW5lZDtcblx0ICAgICAgICBfdGhpcy55ID0gdW5kZWZpbmVkO1xuXHQgICAgICAgIC8vIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCBcImNsaWNrXCIsIHRoaXMub25Nb3VzZUNsaWNrLmJpbmQodGhpcyksIGZhbHNlIClcblx0ICAgICAgICBfdGhpcy5waWNrQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwaWNrLWJ0blwiKTtcblx0ICAgICAgICBfdGhpcy5waWNrSGFuZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicGljay1oYW5kXCIpO1xuXHQgICAgICAgIF90aGlzLnBpY2tCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIF90aGlzLmJ0bk9uQ2xpY2suYmluZChfdGhpcyksIGZhbHNlKTtcblx0ICAgICAgICAvLyB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsdGhpcy5vbk1vdXNlQ2xpY2suYmluZCh0aGlzKSxmYWxzZSlcblx0ICAgICAgICByZXR1cm4gX3RoaXM7XG5cdCAgICB9XG5cdFxuXHQgICAgX2NyZWF0ZUNsYXNzKE1vdXNlLCBbe1xuXHQgICAgICAgIGtleTogXCJvbk1vdXNlQ2xpY2tcIixcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gb25Nb3VzZUNsaWNrKGV2ZW50KSB7XG5cdCAgICAgICAgICAgIC8vIGNhbGN1bGF0ZSBtb3VzZSBwb3NpdGlvbiBpbiBub3JtYWxpemVkIGRldmljZSBjb29yZGluYXRlc1xuXHQgICAgICAgICAgICAvLyAoLTEgdG8gKzEpIGZvciBib3RoIGNvbXBvbmVudHNcblx0ICAgICAgICAgICAgLy8gY29uc29sZS5sb2coZXZlbnQuY2xpZW50WCxldmVudC5jbGllbnRZKVxuXHQgICAgICAgICAgICB0aGlzLnggPSBldmVudC5jbGllbnRYIC8gd2luZG93LmlubmVyV2lkdGggKiAyIC0gMTtcblx0ICAgICAgICAgICAgdGhpcy55ID0gLShldmVudC5jbGllbnRZIC8gd2luZG93LmlubmVySGVpZ2h0KSAqIDIgKyAxO1xuXHQgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLngsdGhpcy55KVxuXHQgICAgICAgIH1cblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6IFwiYnRuT25DbGlja1wiLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBidG5PbkNsaWNrKGV2ZW50KSB7XG5cdCAgICAgICAgICAgIHRoaXMueCA9IDAuNDYgKiAyIC0gMTtcblx0ICAgICAgICAgICAgdGhpcy55ID0gLTAuMzk1ICogMiArIDE7XG5cdCAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMueCx0aGlzLnkpXG5cdCAgICAgICAgfVxuXHQgICAgfV0pO1xuXHRcblx0ICAgIHJldHVybiBNb3VzZTtcblx0fShUSFJFRS5WZWN0b3IyKTtcblx0XG5cdGV4cG9ydHMuZGVmYXVsdCA9IE1vdXNlO1xuXG4vKioqLyB9LFxuLyogMyAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0bW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLnAgKyBcImltYWdlcy9wdXp6bGVzL2NhcnRvb24gKDMpLmpwZ1wiO1xuXG4vKioqLyB9LFxuLyogNCAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cblx0bW9kdWxlLmV4cG9ydHMgPSBzd2FsO1xuXG4vKioqLyB9LFxuLyogNSAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cblx0bW9kdWxlLmV4cG9ydHMgPSB0cnVlO1xuXG4vKioqLyB9XG4vKioqKioqLyBdKTtcblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiBWUlB1enpsZS5idW5kbGUuanNcbiAqKi8iLCIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSlcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcblxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0ZXhwb3J0czoge30sXG4gXHRcdFx0aWQ6IG1vZHVsZUlkLFxuIFx0XHRcdGxvYWRlZDogZmFsc2VcbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubG9hZGVkID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCIvVlJQdXp6bGUvcHVibGljL1wiO1xuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKDApO1xuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogd2VicGFjay9ib290c3RyYXAgMTBiNWU3ZWFmMDY0MjVjYzJjMGFcbiAqKi8iLCJpbXBvcnQgJ2JhYmVsLXBvbHlmaWxsJztcclxuaW1wb3J0IEdhbWUgZnJvbSBcIi4vZ2FtZS5qc1wiXHJcbmxldCBnYW1lID0gbmV3IEdhbWUoKVxyXG5cclxuY29uc3QgbG9vcCA9ICgpPT57XHJcbiAgICBnYW1lLnJlbmRlcigpXHJcbiAgICAvLyByZXF1ZXN0QW5pbWF0aW9uRnJhbWUobG9vcClcclxufVxyXG5sb29wKClcclxuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9zcmMvamF2YXNjcmlwdHMvaW5kZXguanNcbiAqKi8iLCJcclxuaW1wb3J0IE1vdXNlIGZyb20gXCIuL21vdXNlLmpzXCJcclxuaW1wb3J0IHN3YWwgZnJvbSBcInN3ZWV0YWxlcnRcIlxyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgR2FtZSB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICAvLyBDcmVhdGUgYSB0aHJlZS5qcyBzY2VuZS5cclxuICAgICAgICB0aGlzLnNjZW5lID0gbmV3IFRIUkVFLlNjZW5lKClcclxuXHJcbiAgICAgICAgLy8gQ3JlYXRlIGEgdGhyZWUuanMgY2FtZXJhLlxyXG4gICAgICAgIHRoaXMuY2FtZXJhID0gbmV3IFRIUkVFLlBlcnNwZWN0aXZlQ2FtZXJhKDc1LCB3aW5kb3cuaW5uZXJXaWR0aCAvIHdpbmRvdy5pbm5lckhlaWdodCwgMC4xLCAxMDAwMClcclxuXHJcbiAgICAgICAgdGhpcy5jYW1lcmEucG9zaXRpb24uc2V0KDAsMTAsMClcclxuICAgICAgICB0aGlzLmNvbnRyb2xzID0gbmV3IFRIUkVFLkRldmljZU9yaWVudGF0aW9uQ29udHJvbHMoIHRoaXMuY2FtZXJhICk7XHJcblxyXG4gICAgICAgIHRoaXMucmVuZGVyZXIgPSBuZXcgVEhSRUUuV2ViR0xSZW5kZXJlcih7XHJcbiAgICAgICAgICAgIGFudGlhbGlhczogdHJ1ZVxyXG4gICAgICAgIH0pO1xyXG5cdFx0dGhpcy5yZW5kZXJlci5zZXRQaXhlbFJhdGlvKCB3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyApO1xyXG5cdFx0dGhpcy5yZW5kZXJlci5zZXRTaXplKHdpbmRvdy5pbm5lcldpZHRoLCB3aW5kb3cuaW5uZXJIZWlnaHQpO1xyXG5cdFx0dGhpcy5yZW5kZXJlci5kb21FbGVtZW50LnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcclxuXHRcdHRoaXMucmVuZGVyZXIuZG9tRWxlbWVudC5zdHlsZS50b3AgPSAwO1xyXG5cdFx0ZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh0aGlzLnJlbmRlcmVyLmRvbUVsZW1lbnQpO1xyXG5cclxuICAgICAgICAvLyByYXljYXN0ZXJcclxuICAgICAgICB0aGlzLnJheWNhc3RlciA9IG5ldyBUSFJFRS5SYXljYXN0ZXIoKVxyXG4gICAgICAgIHRoaXMubW91c2UgPSBuZXcgTW91c2UoKVxyXG4gICAgICAgICAgICAvL2JpbmQgdGhpc1xyXG4gICAgICAgIHRoaXMub25UZXh0dXJlTG9hZGVkID0gdGhpcy5vblRleHR1cmVMb2FkZWQuYmluZCh0aGlzKVxyXG4gICAgICAgIHRoaXMub25SZXNpemUgPSB0aGlzLm9uUmVzaXplLmJpbmQodGhpcylcclxuICAgICAgICB0aGlzLnJlbmRlciA9IHRoaXMucmVuZGVyLmJpbmQodGhpcylcclxuICAgICAgICB0aGlzLnBsYWNlUGllY2VzID0gdGhpcy5wbGFjZVBpZWNlcy5iaW5kKHRoaXMpXHJcbiAgICAgICAgICAgIC8vXHJcbiAgICAgICAgdGhpcy5tZXNoTGlzdCA9IFtdXHJcbiAgICAgICAgdGhpcy5sb2dGbGFnID0gdHJ1ZVxyXG4gICAgICAgICAgICAvLyBBZGQgYSByZXBlYXRpbmcgZ3JpZCBhcyBhIHNreWJveC5cclxuICAgICAgICB0aGlzLmJveFNpemUgPSA1MFxyXG4gICAgICAgIC8vIHRoaXMubG9hZGVyID0gbmV3IFRIUkVFLlRleHR1cmVMb2FkZXIoKVxyXG4gICAgICAgIC8vIHRoaXMubG9hZGVyLmxvYWQoXCJwdWJsaWMvaW1hZ2VzL2JveC5wbmdcIiwgdGhpcy5vblRleHR1cmVMb2FkZWQpXHJcbiAgICAgICAgLy8gbGV0IHRleHR1cmUgPSBuZXcgVEhSRUUuVGV4dHVyZSgpXHJcbiAgICAgICAgdGhpcy5vblRleHR1cmVMb2FkZWQoKVxyXG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwicmVzaXplXCIsIHRoaXMub25SZXNpemUsIHRydWUpXHJcbiAgICAgICAgLy8gd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJ2cmRpc3BsYXlwcmVzZW50Y2hhbmdlXCIsIHRoaXMub25SZXNpemUsIHRydWUpXHJcbiAgICAgICAgdGhpcy5sYXN0UmVuZGVyID0gMFxyXG4gICAgICAgIHRoaXMuZGlzcGxheSA9IG51bGxcclxuICAgIH1cclxuICAgIG9uVGV4dHVyZUxvYWRlZCgpIHtcclxuICAgICAgICAvLyB0ZXh0dXJlLndyYXBTID0gVEhSRUUuUmVwZWF0V3JhcHBpbmdcclxuICAgICAgICAvLyB0ZXh0dXJlLndyYXBUID0gVEhSRUUuUmVwZWF0V3JhcHBpbmdcclxuICAgICAgICAvLyB0ZXh0dXJlLnJlcGVhdC5zZXQodGhpcy5ib3hTaXplLCB0aGlzLmJveFNpemUpXHJcblxyXG4gICAgICAgIGxldCBnZW9tZXRyeSA9IG5ldyBUSFJFRS5Cb3hHZW9tZXRyeSh0aGlzLmJveFNpemUsIHRoaXMuYm94U2l6ZSwgdGhpcy5ib3hTaXplKVxyXG4gICAgICAgIC8vIGxldCBtYXRlcmlhbCA9IG5ldyBUSFJFRS5NZXNoQmFzaWNNYXRlcmlhbCh7IGNvbG9yOiAweGZmMDBmZiwgc2lkZTogVEhSRUUuQmFja1NpZGUgLCB3aXJlZnJhbWU6IHRydWV9IClcclxuICAgICAgICBsZXQgbWF0ZXJpYWwgPSBuZXcgVEhSRUUuTWVzaEJhc2ljTWF0ZXJpYWwoeyBhbHBoYU1hcDogMHgwMDAwMH0gKVxyXG4gICAgICAgIC8vXHJcbiAgICAgICAgLy8gQWxpZ24gdGhlIHNreWJveCB0byB0aGUgZmxvb3IgKHdoaWNoIGlzIGF0IHk9MCkuXHJcbiAgICAgICAgdGhpcy5za3lib3ggPSBuZXcgVEhSRUUuTWVzaChnZW9tZXRyeSwgbWF0ZXJpYWwpXHJcbiAgICAgICAgdGhpcy5za3lib3gucG9zaXRpb24ueSA9IHRoaXMuYm94U2l6ZSAvIDJcclxuICAgICAgICB0aGlzLnNjZW5lLmFkZCh0aGlzLnNreWJveClcclxuICAgICAgICB0aGlzLnBsYWNlUGllY2VzKClcclxuICAgICAgICB0aGlzLnBsYWNlU3BoZXJlKClcclxuICAgIH1cclxuICAgIHBsYWNlU3BoZXJlKCl7XHJcbiAgICAgICAgdmFyIGdlb21ldHJ5ID0gbmV3IFRIUkVFLlNwaGVyZUdlb21ldHJ5KCAxMDAsIDEwMCwgMTAwICk7XHJcbiAgICAgICAgZ2VvbWV0cnkuc2NhbGUoLTEsMSwxKVxyXG5cdFx0Ly8gZ2VvbWV0cnkuc2NhbGUoIC0gMSwgMSwgMSApO1xyXG4gICAgICAgIC8vIHZhciBzcGhlcmUgPSByZXF1aXJlKFwiLi4vLi4vcHVibGljL2ltYWdlcy9zcGhlcmUgKDIpLmpwZ1wiKVxyXG4gICAgICAgIHZhciBsb2FkZXIgPSBuZXcgVEhSRUUuVGV4dHVyZUxvYWRlcigpXHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzXHJcbiAgICAgICAgbG9hZGVyLmxvYWQoXCJwdWJsaWMvaW1hZ2VzL3NwaGVyZSAoMikuanBnXCIsZnVuY3Rpb24odGV4dHVyZSl7XHJcbiAgICAgICAgICAgIHZhciBtYXRlcmlhbCA9IG5ldyBUSFJFRS5NZXNoQmFzaWNNYXRlcmlhbCgge1xyXG4gICAgXHRcdFx0bWFwOiB0ZXh0dXJlXHJcbiAgICBcdFx0fSk7XHJcblxyXG4gICAgXHRcdHZhciBtZXNoID0gbmV3IFRIUkVFLk1lc2goIGdlb21ldHJ5LCBtYXRlcmlhbCApO1xyXG4gICAgICAgICAgICBtZXNoLnBvc2l0aW9uLnNldCgwLDAsMTApXHJcbiAgICBcdFx0c2VsZi5zY2VuZS5hZGQoIG1lc2ggKTtcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG4gICAgcGxhY2VQaWVjZXMoKSB7XHJcblxyXG4gICAgICAgIHRoaXMuY29sdW1uTnVtYmVyID0gNFxyXG4gICAgICAgIHRoaXMucGllY2VOdW1iZXIgPSB0aGlzLmNvbHVtbk51bWJlciAqIHRoaXMuY29sdW1uTnVtYmVyXHJcbiAgICAgICAgdGhpcy5zY2FsZWRXaWR0aCA9IDE2XHJcbiAgICAgICAgdGhpcy5zY2FsZWRIZWlnaHQgPSA5XHJcbiAgICAgICAgdGhpcy5mcmVlUGllY2VOdW1iZXIgPSB0aGlzLnBpZWNlTnVtYmVyICogMSAvIDJcclxuICAgICAgICB0aGlzLmZyZWVQaWVjZUxpc3QgPSBbXVxyXG4gICAgICAgIHRoaXMucGxhbmVXaWR0aCA9IHRoaXMuc2NhbGVkV2lkdGggLyB0aGlzLmNvbHVtbk51bWJlclxyXG4gICAgICAgIHRoaXMucGxhbmVIZWlnaHQgPSB0aGlzLnNjYWxlZEhlaWdodCAvIHRoaXMuY29sdW1uTnVtYmVyXHJcbiAgICAgICAgdGhpcy5zZWxlY3RlZE1lc2ggPSBudWxsIC8vdGhlIGxhc3QgY2xpY2tlZCBtZXNoSWRcclxuICAgICAgICB0aGlzLmhvbGRNYXAgPSB7fVxyXG4gICAgICAgIHRoaXMubWVzaENhbnZhc01hcCA9IHt9XHJcbiAgICAgICAgbGV0IGltYWdlT2JqID0gbmV3IEltYWdlKClcclxuICAgICAgICBpbWFnZU9iai5zcmMgPSByZXF1aXJlKFwiLi4vLi4vcHVibGljL2ltYWdlcy9wdXp6bGVzL2NhcnRvb24gKDMpLmpwZ1wiKVxyXG4gICAgICAgIGxldCBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpXHJcbiAgICAgICAgbGV0IGNvbnRleHQgPSBjYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpXHJcbiAgICAgICAgbGV0IHNlbGYgPSB0aGlzXHJcbiAgICAgICAgaW1hZ2VPYmoub25sb2FkID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIC8vIGxldCB3cyA9IChjYW52YXMud2lkdGggKSAvIGltYWdlT2JqLndpZHRoXHJcbiAgICAgICAgICAgIC8vIGxldCBocyA9IChjYW52YXMuaGVpZ2h0KSAvIGltYWdlT2JqLmhlaWdodFxyXG4gICAgICAgICAgICAvLyBzZWxmLnNjYWxlID0gTWF0aC5taW4od3MsIGhzKVxyXG4gICAgICAgICAgICBzZWxmLnBpZWNlV2lkdGggPSBpbWFnZU9iai53aWR0aCAvIHNlbGYuY29sdW1uTnVtYmVyXHJcbiAgICAgICAgICAgIHNlbGYucGllY2VIZWlnaHQgPSBpbWFnZU9iai5oZWlnaHQgLyBzZWxmLmNvbHVtbk51bWJlclxyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMCwgaW5kZXggPSAwLCB0ZXh0dXJlLCBtYXRlcmlhbCwgbWVzaDsgaSA8IHNlbGYuY29sdW1uTnVtYmVyOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgc2VsZi5jb2x1bW5OdW1iZXI7IGorKywgaW5kZXgrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIilcclxuICAgICAgICAgICAgICAgICAgICBjb250ZXh0ID0gY2FudmFzLmdldENvbnRleHQoXCIyZFwiKVxyXG4gICAgICAgICAgICAgICAgICAgIHRleHR1cmUgPSBuZXcgVEhSRUUuVGV4dHVyZShjYW52YXMpXHJcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dC5kcmF3SW1hZ2UoaW1hZ2VPYmosIGkgKiBzZWxmLnBpZWNlV2lkdGgsIGogKiBzZWxmLnBpZWNlSGVpZ2h0LCBzZWxmLnBpZWNlV2lkdGgsIHNlbGYucGllY2VIZWlnaHQsIDAsIDAsIGNhbnZhcy53aWR0aCwgY2FudmFzLmhlaWdodClcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGV4dHVyZSkgLy8gY2hlY2tzIGlmIHRleHR1cmUgZXhpc3RzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHR1cmUubmVlZHNVcGRhdGUgPSB0cnVlXHJcblxyXG4gICAgICAgICAgICAgICAgICAgIG1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hCYXNpY01hdGVyaWFsKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWFwOiB0ZXh0dXJlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzaWRlOiBUSFJFRS5Eb3VibGVTaWRlXHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICBtYXRlcmlhbC50cmFuc3BhcmVudCA9IGZhbHNlXHJcblxyXG4gICAgICAgICAgICAgICAgICAgIG1lc2ggPSBuZXcgVEhSRUUuTWVzaChcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IFRIUkVFLlBsYW5lR2VvbWV0cnkoc2VsZi5wbGFuZVdpZHRoLCBzZWxmLnBsYW5lSGVpZ2h0KSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gbmV3IFRIUkVFLlNwaGVyZUdlb21ldHJ5KDUwLDUwLDUwLDAsTWF0aC5QSS8xNixNYXRoLlBJLzIsTWF0aC5QSS8yNCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hdGVyaWFsXHJcbiAgICAgICAgICAgICAgICAgICAgKVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBsZXQgcmFuZG9tID0gTWF0aC5yYW5kb20oKVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChyYW5kb20gPCBzZWxmLmZyZWVQaWVjZU51bWJlciAvIChzZWxmLmNvbHVtbk51bWJlciAqIHNlbGYuY29sdW1uTnVtYmVyIC0gaW5kZXgpICYmIHNlbGYuZnJlZVBpZWNlTnVtYmVyID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgeCA9IC1zZWxmLmJveFNpemUgLyAyICsgc2VsZi5wbGFuZVdpZHRoIC8gMiArIE1hdGgucmFuZG9tKCkgKiAoc2VsZi5ib3hTaXplIC0gc2VsZi5wbGFuZVdpZHRoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgeiA9IC1zZWxmLmJveFNpemUgLyAyICsgc2VsZi5wbGFuZUhlaWdodCAvIDIgKyBNYXRoLnJhbmRvbSgpICogKHNlbGYuYm94U2l6ZSAtIHNlbGYucGxhbmVIZWlnaHQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc2gucm90YXRpb24ueCA9IE1hdGguUEkgLyAyXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc2gucG9zaXRpb24uc2V0KE1hdGgucm91bmQoeCksIDAuNSwgTWF0aC5yb3VuZCh6KSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGJsYW5rTWVzaCA9IG1lc2guY2xvbmUoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmhvbGRNYXBbbWVzaC5pZF0gPSBibGFua01lc2hcclxuICAgICAgICAgICAgICAgICAgICAgICAgYmxhbmtNZXNoLnJvdGF0aW9uLnggPSAwXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsYW5rTWVzaC5tYXRlcmlhbCA9IG5ldyBUSFJFRS5NZXNoQmFzaWNNYXRlcmlhbCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogMHg4MDgwODAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaWRlOiBUSFJFRS5Eb3VibGVTaWRlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsYW5rTWVzaC5wb3NpdGlvbi5zZXQoaSpzZWxmLnBsYW5lV2lkdGggLSBzZWxmLnNjYWxlZFdpZHRoIC8gMiArIHNlbGYucGxhbmVXaWR0aCAvIDIsIDUgKyBzZWxmLnNjYWxlZEhlaWdodCAtIHNlbGYucGxhbmVIZWlnaHQgLyAyIC0gaiAqIHNlbGYucGxhbmVIZWlnaHQsIC05Ljk5KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnNjZW5lLmFkZChibGFua01lc2gpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuZnJlZVBpZWNlTnVtYmVyLS1cclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5mcmVlUGllY2VMaXN0LnB1c2gobWVzaC5pZClcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5tZXNoQ2FudmFzTWFwW21lc2guaWRdID0gY2FudmFzXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWVzaC5wb3NpdGlvbi5zZXQoaSAqIHNlbGYucGxhbmVXaWR0aCAtIHNlbGYuc2NhbGVkV2lkdGggLyAyICsgc2VsZi5wbGFuZVdpZHRoIC8gMiwgNSArIHNlbGYuc2NhbGVkSGVpZ2h0IC0gc2VsZi5wbGFuZUhlaWdodCAvIDIgLSBqICogc2VsZi5wbGFuZUhlaWdodCwgLTkuOTkpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIG1lc2gucG9zaXRpb24uc2V0KDAsIDIsLTkpXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5tZXNoTGlzdC5wdXNoKG1lc2gpXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5zY2VuZS5hZGQobWVzaClcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2codHlwZW9mIHRoaXMuc2NlbmUpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJlbmRlcih0aW1lc3RhbXApIHtcclxuICAgICAgICAvLyB2YXIgZGVsdGEgPSBNYXRoLm1pbih0aW1lc3RhbXAgLSB0aGlzLmxhc3RSZW5kZXIsIDUwMClcclxuICAgICAgICB0aGlzLmxhc3RSZW5kZXIgPSB0aW1lc3RhbXBcclxuICAgICAgICAgICAgLy/lpITnkIbpvKDmoIfngrnlh7tcclxuICAgICAgICB0aGlzLnJheWNhc3Rlci5zZXRGcm9tQ2FtZXJhKHRoaXMubW91c2UsIHRoaXMuY2FtZXJhKVxyXG4gICAgICAgIGxldCBpbnRlcnNlY3RzID0gdGhpcy5yYXljYXN0ZXIuaW50ZXJzZWN0T2JqZWN0cyh0aGlzLnNjZW5lLmNoaWxkcmVuKVxyXG4gICAgICAgIHRoaXMubW91c2UueCA9IHRoaXMubW91c2UueSA9IHVuZGVmaW5lZFxyXG4gICAgICAgIGlmIChpbnRlcnNlY3RzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coaW50ZXJzZWN0cylcclxuICAgICAgICAgICAgbGV0IGNsaWNrRmxhZyA9IGZhbHNlXHJcbiAgICAgICAgICAgIGZvciAobGV0IG1lc2ggb2YgdGhpcy5tZXNoTGlzdCkge1xyXG5cclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmZyZWVQaWVjZUxpc3QuaW5kZXhPZihtZXNoLmlkKSA+IC0xICYmIG1lc2guaWQgPT0gaW50ZXJzZWN0c1swXS5vYmplY3QuaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZih0aGlzLnNlbGVjdGVkTWVzaCE9PW51bGwpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNsZWFyQ2FudmFzKClcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZE1lc2gudmlzaWJsZSA9IHRydWVcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZE1lc2ggPSBtZXNoXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tb3VzZS5waWNrQnRuLmlubmVySFRNTCA9IFwi6LS05LiKXCJcclxuICAgICAgICAgICAgICAgICAgICBjbGlja0ZsYWcgPSB0cnVlXHJcblxyXG4gICAgICAgICAgICAgICAgICAgIG1lc2gudmlzaWJsZSA9IGZhbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwaW5cIikuYXBwZW5kQ2hpbGQodGhpcy5tZXNoQ2FudmFzTWFwW21lc2guaWRdKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmKHRoaXMuc2VsZWN0ZWRNZXNoICYmIHRoaXMuaG9sZE1hcFt0aGlzLnNlbGVjdGVkTWVzaC5pZF0uaWQgPT0gaW50ZXJzZWN0c1swXS5vYmplY3QuaWQpe1xyXG4gICAgICAgICAgICAgICAgbGV0IHQgPSBpbnRlcnNlY3RzWzBdLm9iamVjdC5wb3NpdGlvblxyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZE1lc2gucG9zaXRpb24uc2V0KHQueCx0LnksdC56KVxyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZE1lc2gucm90YXRpb24uc2V0KDAsMCwwKVxyXG4gICAgICAgICAgICAgICAgdGhpcy5ob2xkTWFwW3RoaXMuc2VsZWN0ZWRNZXNoLmlkXS5wb3NpdGlvbi56IC09IDFcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRNZXNoLnZpc2libGUgPSB0cnVlXHJcbiAgICAgICAgICAgICAgICB0aGlzLm1vdXNlLnBpY2tCdG4uaW5uZXJIVE1MID0gXCLmjaHotbdcIlxyXG4gICAgICAgICAgICAgICAgLy/lnKjmnKrmi7zmiJDlm77niYfliJfooajkuK3lj5blh7rlvZPliY3poblcclxuICAgICAgICAgICAgICAgIHRoaXMuZnJlZVBpZWNlTGlzdC5zcGxpY2UodGhpcy5mcmVlUGllY2VMaXN0LmluZGV4T2YodGhpcy5zZWxlY3RlZE1lc2guaWQpLDEpXHJcbiAgICAgICAgICAgICAgICAvL+a4healmuW9k+WJjemAieWPlueahOWbvuWDj1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jbGVhckNhbnZhcygpXHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkTWVzaCA9IG51bGxcclxuICAgICAgICAgICAgICAgIGlmKHRoaXMuZnJlZVBpZWNlTGlzdC5sZW5ndGggPT0gMCl7XHJcbiAgICAgICAgICAgICAgICAgICAgc3dhbCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOlwi5oGt5Zac77yBXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IFwi5oiQ5Yqf5ou85a6M5LqG5LiA5byg5Zu+77yM5Y+v5piv5oiR5Lmf5LiN5Lya57uZ5L2g5rWB6YePXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiBcIuWlveeahFwiXHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZih0aGlzLnNlbGVjdGVkTWVzaCAmJiAhY2xpY2tGbGFnKXtcclxuICAgICAgICAgICAgICAgIHRoaXMubW91c2UucGlja0J0bi5pbm5lckhUTUwgPSBcIuaNoei1t1wiXHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkTWVzaC52aXNpYmxlID0gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgdGhpcy5jbGVhckNhbnZhcygpXHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkTWVzaCA9IG51bGxcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5jb250cm9scy51cGRhdGUoKVxyXG4gICAgICAgIHRoaXMucmVuZGVyZXIucmVuZGVyKHRoaXMuc2NlbmUsdGhpcy5jYW1lcmEpXHJcblxyXG4gICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLnJlbmRlcilcclxuICAgIH1cclxuICAgIG9uUmVzaXplKGUpIHtcclxuICAgICAgICB0aGlzLmNhbWVyYS5hc3BlY3QgPSB3aW5kb3cuaW5uZXJXaWR0aCAvIHdpbmRvdy5pbm5lckhlaWdodDtcclxuXHRcdHRoaXMuY2FtZXJhLnVwZGF0ZVByb2plY3Rpb25NYXRyaXgoKTtcclxuXHRcdHRoaXMucmVuZGVyZXIuc2V0U2l6ZSggd2luZG93LmlubmVyV2lkdGgsIHdpbmRvdy5pbm5lckhlaWdodCApO1xyXG4gICAgfVxyXG4gICAgY2xlYXJDYW52YXMoKXtcclxuICAgICAgICBsZXQgY2FudmFzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwaW4gY2FudmFzXCIpXHJcbiAgICAgICAgbGV0IHBpbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicGluXCIpXHJcbiAgICAgICAgd2hpbGUoY2FudmFzIT1udWxsKXtcclxuICAgICAgICAgICAgcGluLnJlbW92ZUNoaWxkKGNhbnZhcylcclxuICAgICAgICAgICAgY2FudmFzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwaW4gY2FudmFzXCIpXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL2phdmFzY3JpcHRzL2dhbWUuanNcbiAqKi8iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBNb3VzZSBleHRlbmRzIFRIUkVFLlZlY3RvcjJ7XHJcbiAgICBjb25zdHJ1Y3Rvcihwcm9wcyl7XHJcbiAgICAgICAgc3VwZXIocHJvcHMpXHJcbiAgICAgICAgdGhpcy54ID0gdW5kZWZpbmVkXHJcbiAgICAgICAgdGhpcy55ID0gdW5kZWZpbmVkXHJcbiAgICAgICAgLy8gd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoIFwiY2xpY2tcIiwgdGhpcy5vbk1vdXNlQ2xpY2suYmluZCh0aGlzKSwgZmFsc2UgKVxyXG4gICAgICAgIHRoaXMucGlja0J0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicGljay1idG5cIilcclxuICAgICAgICB0aGlzLnBpY2tIYW5kID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwaWNrLWhhbmRcIilcclxuICAgICAgICB0aGlzLnBpY2tCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsdGhpcy5idG5PbkNsaWNrLmJpbmQodGhpcyksZmFsc2UpXHJcbiAgICAgICAgLy8gd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLHRoaXMub25Nb3VzZUNsaWNrLmJpbmQodGhpcyksZmFsc2UpXHJcbiAgICB9XHJcbiAgICBvbk1vdXNlQ2xpY2soIGV2ZW50ICkge1xyXG4gICAgXHQvLyBjYWxjdWxhdGUgbW91c2UgcG9zaXRpb24gaW4gbm9ybWFsaXplZCBkZXZpY2UgY29vcmRpbmF0ZXNcclxuICAgIFx0Ly8gKC0xIHRvICsxKSBmb3IgYm90aCBjb21wb25lbnRzXHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coZXZlbnQuY2xpZW50WCxldmVudC5jbGllbnRZKVxyXG4gICAgICAgIHRoaXMueCA9ICggZXZlbnQuY2xpZW50WCAvIHdpbmRvdy5pbm5lcldpZHRoICkgKiAyIC0gMVxyXG4gICAgICAgIHRoaXMueSA9IC0gKCBldmVudC5jbGllbnRZIC8gd2luZG93LmlubmVySGVpZ2h0ICkgKiAyICsgMVxyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMueCx0aGlzLnkpXHJcbiAgICB9XHJcbiAgICBidG5PbkNsaWNrKCBldmVudCApIHtcclxuICAgICAgICB0aGlzLnggPSAoIDAuNDYgKSAqIDIgLSAxXHJcbiAgICAgICAgdGhpcy55ID0gLSAoIDAuMzk1ICkgKiAyICsgMVxyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMueCx0aGlzLnkpXHJcbiAgICB9XHJcbn1cclxuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9zcmMvamF2YXNjcmlwdHMvbW91c2UuanNcbiAqKi8iLCJtb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19wdWJsaWNfcGF0aF9fICsgXCJpbWFnZXMvcHV6emxlcy9jYXJ0b29uICgzKS5qcGdcIjtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vcHVibGljL2ltYWdlcy9wdXp6bGVzL2NhcnRvb24gKDMpLmpwZ1xuICoqIG1vZHVsZSBpZCA9IDNcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsIm1vZHVsZS5leHBvcnRzID0gc3dhbDtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIGV4dGVybmFsIFwic3dhbFwiXG4gKiogbW9kdWxlIGlkID0gNFxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwibW9kdWxlLmV4cG9ydHMgPSB0cnVlO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogZXh0ZXJuYWwgXCJ0cnVlXCJcbiAqKiBtb2R1bGUgaWQgPSA1XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iXSwic291cmNlUm9vdCI6IiJ9